var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var b,k=[];!(b=a.next()).done;)k.push(b.value);return k};
$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,k){if(a==Array.prototype||a==Object.prototype)return a;a[b]=k.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var k=a[b];if(k&&k.Math==Math)return k}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var k=$jscomp.propertyToPolyfillSymbol[b];if(null==k)return a[b];k=a[k];return void 0!==k?k:a[b]};
$jscomp.polyfill=function(a,b,k,n){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,k,n):$jscomp.polyfillUnisolated(a,b,k,n))};$jscomp.polyfillUnisolated=function(a,b,k,n){k=$jscomp.global;a=a.split(".");for(n=0;n<a.length-1;n++){var u=a[n];if(!(u in k))return;k=k[u]}a=a[a.length-1];n=k[a];b=b(n);b!=n&&null!=b&&$jscomp.defineProperty(k,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,k,n){var u=a.split(".");a=1===u.length;n=u[0];n=!a&&n in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var q=0;q<u.length-1;q++){var f=u[q];if(!(f in n))return;n=n[f]}u=u[u.length-1];k=$jscomp.IS_SYMBOL_NATIVE&&"es6"===k?n[u]:null;b=b(k);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,u,{configurable:!0,writable:!0,value:b}):b!==k&&(void 0===$jscomp.propertyToPolyfillSymbol[u]&&(k=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[u]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(u):$jscomp.POLYFILL_PREFIX+k+"$"+u),$jscomp.defineProperty(n,$jscomp.propertyToPolyfillSymbol[u],{configurable:!0,writable:!0,value:b})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(a){if(a)return a;var b=function(q,f){this.$jscomp$symbol$id_=q;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:f})};b.prototype.toString=function(){return this.$jscomp$symbol$id_};var k="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",n=0,u=function(q){if(this instanceof u)throw new TypeError("Symbol is not a constructor");return new b(k+(q||"")+"_"+n++,q)};return u},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),k=0;k<b.length;k++){var n=$jscomp.global[b[k]];"function"===typeof n&&"function"!=typeof n.prototype[a]&&$jscomp.defineProperty(n.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var k=0,n=!1,u={next:function(){if(!n&&k<a.length){var q=k++;return{value:b(q,a[q]),done:!1}}n=!0;return{done:!0,value:void 0}}};u[Symbol.iterator]=function(){return u};return u};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(k,n,u){return k==a&&"q"==n&&u==b}}));return!0===b.q}catch(k){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.polyfill("WeakMap",function(a){function b(){if(!a||!Object.seal)return!1;try{var e=Object.seal({}),d=Object.seal({}),m=new a([[e,2],[d,3]]);if(2!=m.get(e)||3!=m.get(d))return!1;m.delete(e);m.set(d,4);return!m.has(e)&&4==m.get(d)}catch(w){return!1}}function k(){}function n(e){var d=typeof e;return"object"===d&&null!==e||"function"===d}function u(e){if(!$jscomp.owns(e,f)){var d=new k;$jscomp.defineProperty(e,f,{value:d})}}function q(e){if(!$jscomp.ISOLATE_POLYFILLS){var d=Object[e];d&&(Object[e]=
function(m){if(m instanceof k)return m;Object.isExtensible(m)&&u(m);return d(m)})}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var f="$jscomp_hidden_"+Math.random();q("freeze");q("preventExtensions");q("seal");var g=0,c=function(e){this.id_=(g+=Math.random()+1).toString();if(e){e=$jscomp.makeIterator(e);for(var d;!(d=e.next()).done;)d=d.value,this.set(d[0],d[1])}};c.prototype.set=function(e,d){if(!n(e))throw Error("Invalid WeakMap key");
u(e);if(!$jscomp.owns(e,f))throw Error("WeakMap key fail: "+e);e[f][this.id_]=d;return this};c.prototype.get=function(e){return n(e)&&$jscomp.owns(e,f)?e[f][this.id_]:void 0};c.prototype.has=function(e){return n(e)&&$jscomp.owns(e,f)&&$jscomp.owns(e[f],this.id_)};c.prototype.delete=function(e){return n(e)&&$jscomp.owns(e,f)&&$jscomp.owns(e[f],this.id_)?delete e[f][this.id_]:!1};return c},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),e=new a($jscomp.makeIterator([[c,"s"]]));if("s"!=e.get(c)||1!=e.size||e.get({x:4})||e.set({x:4},"t")!=e||2!=e.size)return!1;var d=e.entries(),m=d.next();if(m.done||m.value[0]!=c||"s"!=m.value[1])return!1;m=d.next();return m.done||4!=m.value[0].x||"t"!=m.value[1]||!d.next().done?!1:!0}catch(w){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var k=new WeakMap,n=function(c){this.data_={};this.head_=f();this.size=0;if(c){c=$jscomp.makeIterator(c);for(var e;!(e=c.next()).done;)e=e.value,this.set(e[0],e[1])}};n.prototype.set=function(c,e){c=0===c?0:c;var d=u(this,c);d.list||(d.list=this.data_[d.id]=[]);d.entry?d.entry.value=e:(d.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:c,value:e},d.list.push(d.entry),
this.head_.previous.next=d.entry,this.head_.previous=d.entry,this.size++);return this};n.prototype.delete=function(c){c=u(this,c);return c.entry&&c.list?(c.list.splice(c.index,1),c.list.length||delete this.data_[c.id],c.entry.previous.next=c.entry.next,c.entry.next.previous=c.entry.previous,c.entry.head=null,this.size--,!0):!1};n.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=f();this.size=0};n.prototype.has=function(c){return!!u(this,c).entry};n.prototype.get=function(c){return(c=
u(this,c).entry)&&c.value};n.prototype.entries=function(){return q(this,function(c){return[c.key,c.value]})};n.prototype.keys=function(){return q(this,function(c){return c.key})};n.prototype.values=function(){return q(this,function(c){return c.value})};n.prototype.forEach=function(c,e){for(var d=this.entries(),m;!(m=d.next()).done;)m=m.value,c.call(e,m[1],m[0],this)};n.prototype[Symbol.iterator]=n.prototype.entries;var u=function(c,e){var d=e&&typeof e;"object"==d||"function"==d?k.has(e)?d=k.get(e):
(d=""+ ++g,k.set(e,d)):d="p_"+e;var m=c.data_[d];if(m&&$jscomp.owns(c.data_,d))for(c=0;c<m.length;c++){var w=m[c];if(e!==e&&w.key!==w.key||e===w.key)return{id:d,list:m,index:c,entry:w}}return{id:d,list:m,index:-1,entry:void 0}},q=function(c,e){var d=c.head_;return $jscomp.iteratorPrototype(function(){if(d){for(;d.head!=c.head_;)d=d.previous;for(;d.next!=d.head;)return d=d.next,{done:!1,value:e(d)};d=null}return{done:!0,value:void 0}})},f=function(){var c={};return c.previous=c.next=c.head=c},g=0;
return n},"es6","es3");$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(a,b){for(var k=1;k<arguments.length;k++){var n=arguments[k];if(n)for(var u in n)$jscomp.owns(n,u)&&(a[u]=n[u])}return a};$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");
function SubtitlesForLLAmazonPageChanger(a){function b(c){return n(c,{tag:g,subtitles_for_language_learning:"enable",autoplay:"1"})}function k(c){return n(c,{subtitles_for_language_learning:"disable"})}function n(c,e){if(null==e)return c;c=new URL(c);var d={};if(c.search&&0<c.search.length)for(var m=c.search.substring(1).split("&"),w=0;w<m.length;w++){var x=m[w].split("=");d[decodeURIComponent(x[0])]=decodeURIComponent(x[1])}Object.keys(e).forEach(function(t,p){e[t]&&(d[t]=e[t])});var D=[];m=Object.keys(d);
m.sort(function(t,p){return t<p?-1:1});m.forEach(function(t,p){D.push(encodeURIComponent(t)+"="+encodeURIComponent(d[t]))});return c.protocol+"//"+c.host+c.pathname+"?"+D.join("&")}var u=!1,q=!1,f=a.localize,g=subtitlesForLL.amazon.getAffiliateId(null,subtitlesForLL.configs.amazonRegion);this.addSubtitlePlayButton=function(){function c(t,p){if(null==t)var C=document.getElementsByClassName(p);else{C=[];for(var A=0;A<t.length;A++)for(var v=t[A].addedNodes,l=0;l<v.length;l++){var h=subtitlesForLL.getElementsByClassNameFromAddedNode(v[l],
p);C=C.concat(h)}}return C}function e(){function t(){var C=chrome.extension.getURL("/icons/logo.svg"),A=document.createElement("div");A.className="subtitles_fll_seek_enable_link";A.style.cssText="display:inline-block; height:18px; margin:0px 10px; color:#999; font-size:10px; vertical-align:top; white-space:nowrap; cursor:pointer;";var v=subtitlesForLL.isEnableSubtitleViewer?f("Turn OFF"):f("Turn ON");A.innerHTML='<img src="'+C+'" alt='+v+' title="'+v+'" style="width:18px; height:18px; border-radius:40%; margin:0px 5px;"><div style="display:inline-block; line-height:18px; vertical-align:top;"><span style="vertical-align:middle;">'+
v+"</span></div>";A.onclick=function(l){if(null==subtitlesForLL.currentCatalogId)console.error("currentCatalogID\u304cnull\u306a\u306e\u3067\u518d\u751fURL\u3092\u751f\u6210\u51fa\u6765\u307e\u305b\u3093\u3002");else return l=subtitlesForLL.amazon.detailURL(subtitlesForLL.currentCatalogId)+"/?autoplay=1",l+="&time="+parseInt(subtitlesForLL.subtitleViewer&&subtitlesForLL.subtitleViewer.currentVideoElem&&null!=subtitlesForLL.subtitleViewer.currentVideoElem.currentTime?subtitlesForLL.subtitleViewer.currentVideoElem.currentTime:
0),null!=g&&(l+="&tags="+g),l=subtitlesForLL.isEnableSubtitleViewer?k(l):b(l),location.href=l,!1};return A}var p=document.body.querySelector(".atvwebplayersdk-infobar-container .f1iltifw")||document.body.querySelector(".atvwebplayersdk-infobar-container .fud1t1u");if(p){if(0<p.getElementsByTagName("subtitles_fll_seek_enable_link").length)return!1;p.insertAdjacentElement("beforeend",t())}else{p=document.body.querySelector(".bottomPanelItem .infoBar .center");if(null==p||0<p.getElementsByTagName("subtitles_fll_seek_enable_link").length)return!1;
p.insertAdjacentElement("afterbegin",t())}return!0}function d(t){t=c(t,"s-play-button");if(null==t||0>=t.length)return!1;for(var p=0;p<t.length;p++){var C=t[p].closest("a");if(null!=C||null!=C.href.match(/watch\.amazon\..+\/watch|\/gp\/video\/.+/mi)){var A=C.closest("div");if(null!=A&&!(0<A.parentElement.getElementsByClassName("subtitles_fll_enable_link_container").length)){var v=C.href.match(/ru=(.+?)(?:&|$)/mi),l=void 0;v&&v[1]&&(v=b(decodeURIComponent(v[1])).match(/(?:\?|&)gti=(.+?)(?:&|$)/mi))&&
v[1]&&(l=b(subtitlesForLL.amazon.detailURL(v[1])));if(null==l){v=C.href.match(/(?:asin|page-type-id)=([^&\/?]+)/mi);if(null==v||null==v[1]){console.warn("\u30ea\u30f3\u30af\u304b\u3089ASIN\u3092\u62bd\u51fa\u51fa\u6765\u307e\u305b\u3093\u3067\u3057\u305f m = "+v+", href = "+C.href);continue}l=b(subtitlesForLL.amazon.detailURL(v[1]))}C=document.createElement("div");C.className="subtitles_fll_enable_link_container";C.innerHTML='<a href="'+l+'" style="text-decoration:none; pointer-events:auto;"><div class="subtitles_fll_green_link" style="padding: 0px 5px;border-radius: 4px;color: #fff;height:40px;display: flex;margin-right: 15px;width: 126px;"><div style="align-items: center;margin: 0px 0px;"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="512" height="512" viewBox="0 0 512 512" style="width: 24px;height: 100%;"><g></g><path d="M152.443 136.417l207.114 119.573-207.114 119.593z" fill="#fff"></path></svg></div><div style="align-items:center;margin: auto;font-size: 11px;">Subtitles for LL</div></div></a>';
A.parentElement.insertAdjacentElement("beforeend",C)}}}}function m(t){t=c(t,"tst-play-button");if(null==t||0>=t.length)return!1;for(var p={},C=0;C<t.length;p={$jscomp$loop$prop$amaLinkElem$41:p.$jscomp$loop$prop$amaLinkElem$41,$jscomp$loop$prop$enableSubLinkElem$39:p.$jscomp$loop$prop$enableSubLinkElem$39,$jscomp$loop$prop$removeMO$40:p.$jscomp$loop$prop$removeMO$40},C++)if(p.$jscomp$loop$prop$amaLinkElem$41=t[C],!(0<p.$jscomp$loop$prop$amaLinkElem$41.parentElement.parentElement.parentElement.getElementsByClassName("subtitles_fll_enable_min_link").length)){var A=
"";0<p.$jscomp$loop$prop$amaLinkElem$41.href.length&&(A=b(p.$jscomp$loop$prop$amaLinkElem$41.href));p.$jscomp$loop$prop$amaLinkElem$41.parentElement.parentElement.insertAdjacentHTML("afterend",'<a class="subtitles_fll_enable_min_link" href="'+A+'" style="pointer-events:auto;"><div class="subtitles_fll_green_link" style="width:180px; padding: 0px 10px;border-radius: 25px;color: #fff;height:40px; display: flex; margin-left:0px;"><div style="align-items: center;"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="512" height="512" viewBox="0 0 512 512" style="width: 30px;height: 100%;"><g></g><path d="M152.443 136.417l207.114 119.573-207.114 119.593z" fill="#fff"></path></svg></div><div style="align-items:center; margin:auto; font-size:14px;">Subtitles for LL</div></div></a>');
p.$jscomp$loop$prop$enableSubLinkElem$39=p.$jscomp$loop$prop$amaLinkElem$41.parentElement.parentElement.parentElement.getElementsByClassName("subtitles_fll_enable_min_link").item(0);(new MutationObserver(function(v){return function(l){b(v.$jscomp$loop$prop$amaLinkElem$41.href);null!=v.$jscomp$loop$prop$enableSubLinkElem$39&&(v.$jscomp$loop$prop$enableSubLinkElem$39.href=b(v.$jscomp$loop$prop$amaLinkElem$41.href))}}(p))).observe(p.$jscomp$loop$prop$amaLinkElem$41,{attributes:!0});p.$jscomp$loop$prop$removeMO$40=
new MutationObserver(function(v){return function(l){for(var h=0;h<l.length;h++)for(var r=0;r<l[h].removedNodes.length;r++)if(l[h].removedNodes[r]==v.$jscomp$loop$prop$enableSubLinkElem$39){v.$jscomp$loop$prop$removeMO$40.disconnect();v.$jscomp$loop$prop$removeMO$40=null;v.$jscomp$loop$prop$amaLinkElem$41.parentElement.parentElement.insertAdjacentElement("afterend",v.$jscomp$loop$prop$enableSubLinkElem$39);return}}}(p));p.$jscomp$loop$prop$removeMO$40.observe(p.$jscomp$loop$prop$enableSubLinkElem$39.parentElement,
{childList:!0})}}function w(t){t=null==t?document.body.getElementsByClassName("js-node-episode-container"):c(t,"js-node-episode-container");if(0>=t.length)return!1;for(var p={},C=0;C<t.length;p={$jscomp$loop$prop$svPlayLinkElem$46:p.$jscomp$loop$prop$svPlayLinkElem$46,$jscomp$loop$prop$linkElem$48:p.$jscomp$loop$prop$linkElem$48,$jscomp$loop$prop$removeMO$47:p.$jscomp$loop$prop$removeMO$47},C++)if(p.$jscomp$loop$prop$linkElem$48=t[C].getElementsByTagName("a").item(0),!(null==p.$jscomp$loop$prop$linkElem$48||
0<p.$jscomp$loop$prop$linkElem$48.parentElement.getElementsByClassName("subtitles_fll_enable_link").length)){var A='<a class="subtitles_fll_enable_link" href="'+b(p.$jscomp$loop$prop$linkElem$48.href)+'" style="pointer-events:auto;"><div class="subtitles_fll_green_link" style="position:relative; width:140px; height:50px; padding: 0px 20px 0px 20px;border-radius: 25px;color: #fff;display: flex; margin:10px 0px; box-sizing:content-box;"><div style="position:absolute; top:0; left:0; right:0; bottom:0; height:23px; margin:auto; text-align:center;"><span style="vertical-align: middle; line-height:100%;"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="512" height="512" viewBox="100 100 300 300" style="width: 20px;height: 20px;"><g></g><path d="M152.443 136.417l207.114 119.573-207.114 119.593z" fill="#fff"></path></svg></span>Subtitles for LL</div></div></a>';
p.$jscomp$loop$prop$linkElem$48.insertAdjacentHTML("afterend",A);p.$jscomp$loop$prop$svPlayLinkElem$46=p.$jscomp$loop$prop$linkElem$48.parentElement.getElementsByClassName("subtitles_fll_enable_link")[0];p.$jscomp$loop$prop$svPlayLinkElem$46.onclick=function(v){return function(l){location.replace(v.$jscomp$loop$prop$svPlayLinkElem$46.href);return!1}}(p);(A=p.$jscomp$loop$prop$linkElem$48.parentElement.getElementsByClassName("_1uPj4A"))&&0<A.length&&(A=A[0],p.$jscomp$loop$prop$linkElem$48.parentElement.insertAdjacentElement("beforeend",
A));(new MutationObserver(function(v){return function(l){b(v.$jscomp$loop$prop$linkElem$48.href);l=v.$jscomp$loop$prop$linkElem$48.parentElement.getElementsByClassName("subtitles_fll_enable_link");null==l||0>=l.length||(l=l[0],l.href=b(v.$jscomp$loop$prop$linkElem$48.href))}}(p))).observe(p.$jscomp$loop$prop$linkElem$48,{attributes:!0});subtitlesForLL.isEnableSubtitleViewer&&p.$jscomp$loop$prop$linkElem$48.addEventListener("click",function(v){return function(l){location.replace(v.$jscomp$loop$prop$linkElem$48.href);
l.preventDefault();l.stopImmediatePropagation();return!1}}(p),!0);p.$jscomp$loop$prop$removeMO$47=new MutationObserver(function(v){return function(l){for(var h=0;h<l.length;h++)for(var r=0;r<l[h].removedNodes.length;r++)if(l[h].removedNodes[r]==v.$jscomp$loop$prop$svPlayLinkElem$46){v.$jscomp$loop$prop$removeMO$47.disconnect();v.$jscomp$loop$prop$linkElem$48.insertAdjacentElement("afterend",v.$jscomp$loop$prop$svPlayLinkElem$46);v.$jscomp$loop$prop$removeMO$47.observe(v.$jscomp$loop$prop$linkElem$48.parentElement,
{childList:!0});return}}}(p));p.$jscomp$loop$prop$removeMO$47.observe(p.$jscomp$loop$prop$linkElem$48.parentElement,{childList:!0})}return!0}function x(t){if(t)for(var p=0;p<t.length;p++)for(var C=0;C<t[p].addedNodes.length;C++){var A=subtitlesForLL.getElementByClassNameFromAddedNode(t[p].addedNodes[C],"dv-dp-node-trailer");if(A){var v=A;break}}else v=document.body.getElementsByClassName("dv-dp-node-trailer").item(0);if(null==v)return!1;var l=v.getElementsByTagName("A").item(0);if(null==l)return!1;
subtitlesForLL.isEnableSubtitleViewer&&l.addEventListener("click",function(h){location.replace(l.href);h.preventDefault();h.stopImmediatePropagation()},!0);return!0}function D(t){if(t)for(var p=0;p<t.length;p++)for(var C=0;C<t[p].addedNodes.length;C++){var A=subtitlesForLL.getElementByClassNameFromAddedNode(t[p].addedNodes[C],"dv-dp-node-playback");if(A){var v=[A];break}}else v=document.body.getElementsByClassName("dv-dp-node-playback");if(null==v||0>=v.length)return!1;var l=v[0].getElementsByTagName("a");
if(null==l||0>=l.length||v[0].parentElement.getElementsByClassName("subtitles_fll_enable_link").item(0))return!1;t=b(l[0].href);v[0].insertAdjacentHTML("afterend",'<a class="subtitles_fll_enable_link" href="'+t+'" style="pointer-events:auto;"><div class="subtitles_fll_green_link" style="padding: 0px 20px 0px 20px; border-radius: 4px; color: #fff;"><span style="vertical-align: middle;"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="512" height="512" viewBox="100 100 300 300" style="width: 35px;height: 35px;"><g></g><path d="M152.443 136.417l207.114 119.573-207.114 119.593z" fill="#fff"></path></svg></span><span style="line-height:68px;">Subtitles for LL</span></div></a>');
var h=v[0].parentElement.getElementsByClassName("subtitles_fll_enable_link")[0];h.onclick=function(B){location.replace(h.href);return!1};var r=new MutationObserver(function(B){r.disconnect();l[0].href=k(l[0].href);h.href=b(l[0].href);r.observe(l[0],{attributes:!0})});r.observe(l[0],{attributes:!0});l[0].href=k(l[0].href);subtitlesForLL.isEnableSubtitleViewer&&l[0].addEventListener("click",function(B){location.replace(l[0].href);B.preventDefault();B.stopImmediatePropagation();return!1},!0);var z=new MutationObserver(function(B){for(var E=
0;E<B.length;E++)for(var G=0;G<B[E].removedNodes.length;G++)if(B[E].removedNodes[G]==h){z.disconnect();v[0].insertAdjacentElement("afterend",h);z.observe(h.parentElement,{childList:!0});return}});z.observe(h.parentElement,{childList:!0});return!0}(function(){if(location.host.match(/www\.amazon\..+/mi)&&location.pathname.match(/^\/s$/mi)){var t=document.body.querySelector(".s-main-slot")||document.body;d(null);var p=new MutationObserver(function(r){p.disconnect();d(r);p.observe(t,{childList:!0,subtree:!0})});
p.observe(t,{childList:!0,subtree:!0})}else if(location.pathname.match(/(?:\/gp\/video\/detail|.*\/dp\/.*?|^\/detail)/mi)||"www.primevideo.com"==location.host&&location.pathname.match(/.*\/detail\/.+/mi)){u=D(null);q=x(null);w(null);var C=new MutationObserver(function(r){C.disconnect();0==u&&(u=D(r));0==q&&(q=x(r));w(r);C.observe(document.body,{childList:!0,subtree:!0})});C.observe(document.body,{childList:!0,subtree:!0})}else if(location.pathname.match(/(?:\/gp\/video\/storefront|\/gp\/video\/mystuff|\/Amazon-Video)/mi)||
"www.primevideo.com"==location.host&&location.pathname.match(/(?:\/region\/[^\/]+\/.*$|.*\/storefront|.*\/mystuff|^\/(?:ref=.*)?$)/mi)){m(null);var A=new MutationObserver(function(r){A.disconnect();m(r);A.observe(document.body,{childList:!0,subtree:!0})});A.observe(document.body,{childList:!0,subtree:!0})}else if(location.pathname.match(/\/gp\/video\/search/mi)||"www.primevideo.com"==location.host&&location.pathname.match(/.*\/search/mi)){m(null);var v=new MutationObserver(function(r){v.disconnect();
m(r);v.observe(document.body,{childList:!0,subtree:!0})});v.observe(document.body,{childList:!0,subtree:!0})}var l=!1,h=new MutationObserver(function(r){h.disconnect();if(0==l&&(l=e()))return;h.observe(document.body,{childList:!0,subtree:!0})});h.observe(document.body,{childList:!0,subtree:!0})})()}};function SubtitlesForLLAmazonUIChanger(a){var b=this,k=subtitlesForLL.localize.localize;this.brightness=1;this.subtitlePosition=this.subtitleTimingDifferenceCallback=null;this.defaultTiming=this.timing=0;this.subtitlesMainContainer=this.webPlayerSDKContainer=this.dvWebPlayerElem=this.overlaySubtitleContainerElem=this.adjustmentMenuButtonElem=this.adjustmentMenuElem=null;this.video=a;this.clickedButtonCallback=null;this.changeVideoElem=function(f){b.video=f;b.video.addEventListener("play",function(g){n(!1)});
b.video.addEventListener("pause",function(g){n(!0)})};this.change=function(){b.dvWebPlayerElem=document.getElementById("dv-web-player");if(b.dvWebPlayerElem){b.webPlayerSDKContainer=b.dvWebPlayerElem.querySelector(".webPlayerElement .webPlayerSDKContainer")||b.dvWebPlayerElem.querySelector(".webPlayerElement .cascadesContainer");b.subtitlesMainContainer=document.createElement("div");b.subtitlesMainContainer.id="subtitles_fll_main_container";b.subtitlesMainContainer.style.cssText="position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none;";
b.webPlayerSDKContainer.insertAdjacentElement("beforeend",b.subtitlesMainContainer);var f=b.webPlayerSDKContainer.getElementsByClassName("scalingVideoContainer")[0];f.style.width="calc(100% - "+subtitlesForLL.SUBTITLE_CONTENTS_VIEW_WIDTH+"px)";var g=b.webPlayerSDKContainer.getElementsByClassName("webPlayerUIContainer")[0]||b.webPlayerSDKContainer.getElementsByClassName("scalingUiContainer")[0];g.style.width="calc(100% - "+subtitlesForLL.SUBTITLE_CONTENTS_VIEW_WIDTH+"px)";0==subtitlesForLL.isRightToLeftLanguage(subtitlesForLL.configs.learningLanguage)?
(f.style.left="0px",g.style.marginLeft="0px",g.style.marginRight="auto"):(f.style.right="0px",g.style.marginLeft="auto",g.style.marginRight="0px");b.overlayContainer=document.createElement("div");b.overlayContainer.id="subtitles_fll_overlay_container";b.overlayContainer.style.cssText="position:absolute; width:calc(100% - 400px); height:100%; pointer-events:none; top:0px; left:0px; font-size:14px;";b.overlayContainer.innerHTML='<div style="width:100%; height:100%;"><div style="margin:0; width:100%; height:100%; min-height:0px;"></div><div class="subtitles_fll_overlay_subtitle_container" style="position:absolute; margin:0; padding:0px 5px; width:100%; text-align:center; color:#ddd; font-size:'+
subtitlesForLL.configs.subtitleFontSizeVW+'vw; font-weight:normal;"></div>';b.subtitlesMainContainer.appendChild(b.overlayContainer);b.overlaySubtitleContainerElem=b.overlayContainer.getElementsByClassName("subtitles_fll_overlay_subtitle_container")[0];b.overlayCenterContainer=b.overlayContainer.getElementsByClassName("subtitles_fll_overlay_center_container")[0];(new ResizeObserver(function(d){b.refreshSubtitlePosition();b.refreshAmazonSubtitlePosition()})).observe(b.overlaySubtitleContainerElem.parentElement,
{attributes:!0,attributeFilter:["width","height"]});null==b.webPlayerSDKContainer.getElementsByClassName("atvwebplayersdk-overlays-container").item(0)&&b.webPlayerSDKContainer.getElementsByClassName("overlaysContainer").item(0)}f=b.webPlayerSDKContainer.getElementsByClassName("fofauj8");0>=f.length&&(f=b.webPlayerSDKContainer.getElementsByClassName("gradientOverlay"));for(g=0;g<f.length;g++)f[g].style.backgroundColor="rgba(0,0,0,0)";f=b.webPlayerSDKContainer.getElementsByClassName("atvwebplayersdk-infobar-container").item(0);
null!=f?g=f.childNodes[0]:(f=b.webPlayerSDKContainer.getElementsByClassName("infoBar").item(0),g=f.getElementsByClassName("left").item(0));if(null==g)console.warn("amazon\u306e.atvwebplayersdk-infobar-container\u306echildNodes\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002(\u60f3\u5b9a\u5916)"),console.warn(f.length);else{var c=document.createElement("button");c.ariaLabel="Seek Forward 10 seconds";c.style.cssText="position:relative; width:18px; min-width:18px; height:18px; margin:0px 5px; margin-right:10px; padding:0px; overflow:hidden;";
c.innerHTML='<img style="margin:0px; width:18px; height:18px;" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODUiIHZpZXdCb3g9IjAgMCA4MCA4NSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48dGl0bGU+MTBzIGZvcndhcmQ8L3RpdGxlPjxwYXRoIGQ9Ik02NC4yNCAxNC40NzhsLTMuMjY5IDEuNzUzYzguOTcyIDYuNTU5IDE0LjgwNCAxNy4xNTYgMTQuODA0IDI5LjEyMSAwIDE5LjkxMy0xNi4xNDMgMzYuMDU2LTM2LjA1NyAzNi4wNTYtMTkuOTEzIDAtMzYuMDU2LTE2LjE0My0zNi4wNTYtMzYuMDU2IDAtMTguMjQgMTMuNTQ3LTMzLjMwOCAzMS4xMjctMzUuNzEzdjQuODY4cy0uMDA4Ljk2OC4zMDUgMS4xMDNjLjQyNS4xODMgMS4wNC0uMjI0IDEuMDQtLjIyNEw0OC4wMSA5LjA0OXMuODE4LS4zODYuODE4LS43NGMwLS40MjItLjgxNy0uNzk3LS44MTctLjc5N0wzNS44MzcuODk4cy0uMzY5LS4yNjQtLjc3Mi0uMDQ4Yy0uMjkuMTU0LS4yNzYuODIzLS4yNzYuODIzVjYuMjRDMTUuMzM3IDguNjY2LjI4MiAyNS4yNDMuMjgyIDQ1LjM1MmMwIDIxLjc4IDE3LjY1NiAzOS40MzcgMzkuNDM2IDM5LjQzN3MzOS40MzctMTcuNjU3IDM5LjQzNy0zOS40MzdjMC0xMi41MS01LjgzMS0yMy42NS0xNC45MTUtMzAuODc0IiBmaWxsPSIjRkZGIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=" alt=""><div style="position: absolute; width: 18px; height: 12px; text-align: center; font-size: 10px; margin: auto; top: 0; left: -1px; bottom: 0; right: 0; ">10</div>';
c.onclick=function(d){b.clickedButtonCallback("fastSeekForward")};g.insertAdjacentElement("afterbegin",c);b.playButton=document.createElement("button");b.playButton.style.cssText="position:relative; width:14px; min-width:14px; height:18px; margin:0px 10px; padding:0px; display:none; overflow:hidden;";b.playButton.innerHTML='<img style="margin:0px; width:14px; height:14px; position:absolute;top: 0;left: 0;bottom: 0;right: 0;margin: auto;" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MCIgaGVpZ2h0PSI5MCIgdmlld0JveD0iMCAwIDkwIDkwIj48cGF0aCBmaWxsPSIjRkZGIiBkPSJNODguMTY0IDQyLjc2MWMyLjQ0NyAxLjIzNyAyLjQ0NyAzLjI0MSAwIDQuNDc4TDQuNDM0IDg5LjUxNEMxLjk4NSA5MC43NSAwIDg5LjU0NyAwIDg2LjgzVjMuMTY5QzAgLjQ1IDEuOTg1LS43NTEgNC40MzQuNDg2bDgzLjczIDQyLjI3NXoiLz48L3N2Zz4=" alt="Play">';
b.playButton.onclick=function(d){b.clickedButtonCallback("play")};g.insertAdjacentElement("afterbegin",b.playButton);b.pauseButton=document.createElement("button");b.pauseButton.ariaLabel="";b.pauseButton.style.cssText="position:relative; width:14px; min-width:14px; height:18px; margin:0px 10px; padding:0px; display:block; overflow:hidden;";b.pauseButton.innerHTML='<img style="margin:0px; width:14px; height:14px; position: absolute;top: 0;left: 0;bottom: 0;right: 0;margin: auto;" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NSIgaGVpZ2h0PSI5NSIgdmlld0JveD0iMCAwIDc1IDk1Ij48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMCAwaDI1djk1SDB6TTUwIDBoMjV2OTVINTB6Ii8+PC9zdmc+" alt="Pause">';
b.pauseButton.onclick=function(d){b.clickedButtonCallback("pause")};g.insertAdjacentElement("afterbegin",b.pauseButton);b.video.paused&&n(!0);b.video.addEventListener("play",function(d){n(!1)});b.video.addEventListener("pause",function(d){n(!0)});c=document.createElement("button");c.ariaLabel="Seek Back 10 seconds";c.style.cssText="position:relative; width:18px; min-width:18px; height:18px; margin:0px 5px; padding:0px; overflow:hidden;";c.innerHTML='<img style="margin:0px; width:18px; height:18px;" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODUiIHZpZXdCb3g9IjAgMCA4MCA4NSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48dGl0bGU+MTBzIGJhY2s8L3RpdGxlPjxwYXRoIGQ9Ik0xNS4xOTcgMTQuNDc4bDMuMjY4IDEuNzUzQzkuNDk1IDIyLjc5IDMuNjYyIDMzLjM4NyAzLjY2MiA0NS4zNTJjMCAxOS45MTMgMTYuMTQzIDM2LjA1NiAzNi4wNTYgMzYuMDU2IDE5LjkxNCAwIDM2LjA1Ny0xNi4xNDMgMzYuMDU3LTM2LjA1NiAwLTE4LjI0LTEzLjU0Ny0zMy4zMDgtMzEuMTI3LTM1LjcxM3Y0Ljg2OHMuMDA4Ljk2OC0uMzA1IDEuMTAzYy0uNDI1LjE4My0xLjA0LS4yMjQtMS4wNC0uMjI0TDMxLjQyOCA5LjA0OXMtLjgxOC0uMzg2LS44MTgtLjc0YzAtLjQyMi44MTYtLjc5Ny44MTYtLjc5N0w0My42Ljg5OHMuMzY4LS4yNjQuNzcyLS4wNDhjLjI5LjE1NC4yNzYuODIzLjI3Ni44MjNWNi4yNGMxOS40NTEgMi40MjcgMzQuNTA3IDE5LjAwNCAzNC41MDcgMzkuMTEzIDAgMjEuNzgtMTcuNjU2IDM5LjQzNy0zOS40MzcgMzkuNDM3LTIxLjc4IDAtMzkuNDM2LTE3LjY1Ny0zOS40MzYtMzkuNDM3IDAtMTIuNTEgNS44My0yMy42NSAxNC45MTUtMzAuODc0IiBmaWxsPSIjRkZGIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=" alt=""><div style="position: absolute; width: 18px; height: 12px; text-align: center; font-size: 10px; margin: auto; top: 0; left: -1px; bottom: 0; right: 0; ">10</div>';
c.onclick=function(d){b.clickedButtonCallback("fastSeekBack")};g.insertAdjacentElement("afterbegin",c);b.changeBrightness(subtitlesForLL.configs.brightness||1);b.changeContrast(subtitlesForLL.configs.contrast||1);b.changeSaturate(subtitlesForLL.configs.saturate||1);b.changePlaybackRate(subtitlesForLL.configs.playbackRate||1);u(subtitlesForLL.configs.subtitlePosition||0);c=document.createElement("div");c.classList.add("subtitles_fll_adjust_button");b.adjustmentMenuButtonElem=c;c.style.cssText="margin:0px; padding:0px 10px; cursor:pointer;";
var e=chrome.extension.getURL("icons/adjust.svg");c.innerHTML='<img src="'+e+'" style="margin:0px; width:30px; height:18px; object-fit:cover;">';c.onclick=function(d){b.showAdjustmentMenu()};0==subtitlesForLL.isChromeOSMode?(f=g.getElementsByClassName("fe39tpk"))&&0<f.length&&f[0].insertAdjacentElement("beforebegin",c):f.getElementsByClassName("right").item(0).insertAdjacentElement("afterbegin",c)}};var n=function(f){b.playButton.style.display=f?"block":"none";b.pauseButton.style.display=f?"none":
"block"};this.refreshSubtitlePosition=function(){var f=b.overlaySubtitleContainerElem.parentElement.clientHeight/2+b.overlaySubtitleContainerElem.parentElement.clientWidth*(0<b.video.videoWidth&&0<b.video.videoHeight?b.video.videoHeight/b.video.videoWidth:.42)/2+(null!=b.subtitlePosition?b.subtitlePosition:0);f+b.overlaySubtitleContainerElem.clientHeight>b.overlaySubtitleContainerElem.parentElement.clientHeight&&(f=b.overlaySubtitleContainerElem.parentElement.clientHeight-b.overlaySubtitleContainerElem.clientHeight);
b.overlaySubtitleContainerElem.style.top=f+"px"};this.refreshAmazonSubtitlePosition=function(){var f=b.webPlayerSDKContainer.getElementsByClassName("fk87jrb").item(0),g=b.overlaySubtitleContainerElem.getBoundingClientRect();if(f)f.style.bottom=b.webPlayerSDKContainer.clientHeight-g.top+"px";else if((f=b.webPlayerSDKContainer.getElementsByClassName("persistentPanel").item(0))&&0<f.children.length){for(;;){var c=f.getElementsByTagName("div").item(0);if(null==c)break;f=c}f.style.bottom=b.webPlayerSDKContainer.clientHeight-
g.top+"px"}};this.showAdjustmentMenu=function(){var f=b.webPlayerSDKContainer,g=f.getBoundingClientRect(),c=b.adjustmentMenuButtonElem.getBoundingClientRect(),e=window.pageXOffset+c.right-(g.left+window.pageXOffset)-200;g=window.pageYOffset+c.bottom-(g.top+window.pageYOffset)-500;b.adjustmentMenuElem?(b.adjustmentMenuElem.style.top=g+"px",b.adjustmentMenuElem.style.left=e+"px",b.adjustmentMenuElem.style.display="block",b.changePlaybackRate(b.video.playbackRate)):(e='<div class="subtitles_fll_adjustment_menu_window" style="position:absolute; font-size:14px; white-space:nowrap; overflow:hidden; width:300px; top:'+
g+"px; left:"+e+'px; background-color:rgba(50,50,50,0.7); z-index:10000; border-radius:30px; color:#ddd;"><div style=""><div class="subtitles_fll_adjustment_menu_close" style="width:20px; height:20px; margin:10px; margin-left:auto; padding:10px; box-sizing:content-box; border-radius:50%; cursor:pointer;"><svg viewBox="0 0 612 612" xmlns="http://www.w3.org/2000/svg"><g><line stroke="#ddd" stroke-linecap="undefined" stroke-linejoin="undefined" id="svg_1" y2="561.45315" x2="561.49999" y1="48.45311" x1="51.5" stroke-width="99" fill="none"/><line stroke="#ddd" stroke-linecap="undefined" stroke-linejoin="undefined" id="svg_2" y2="562" x2="561" y1="50" x1="50" stroke-width="99" fill="none"/><line transform="rotate(90 305.5,306.00000000000006) " stroke="#ddd" stroke-linecap="undefined" stroke-linejoin="undefined" id="svg_4" y2="562" x2="561" y1="50" x1="50" stroke-width="99" fill="none"/></g></svg></div></div><div style="margin:10px;"><div style="margin:0px 10px;">'+
k("Subtitle timing")+'</div><div style="display:flex; width:100%;"><div style="flex-grow:1;"><input class="subtitles_fll_input_range_subtitle_timing" type="range" value="'+Number(b.timing)+'" min="-20" max="20" step="0.5" style="width:100%; height:5px; background:#ddd; appearance:none; border-radius:3px; outline:none;"></div><div style="flex-grow:0; width:65px; margin:0px 10px;"><input class="subtitles_fll_input_text_subtitle_timing" type="number" value="'+Number(b.timing)+'" step="0.5" style="width:100%; height:25px; border-radius:10px; border:none; text-align:right; background-color:#ddd;"></div></div></div><div style="margin:10px;"><div style="margin:0px 10px;">'+
k("Subtitle position")+'</span></div><div style="display:flex; width:100%;"><div style="flex-grow:1;"><input class="subtitles_fll_input_range_subtitle_pos" type="range" min="-100" max="100" step="1" value="'+b.subtitlePosition+'" style="width:100%; height:5px; background:#ddd; appearance:none; border-radius:3px; outline:none;"></div><div style="flex-grow:0; width:65px; margin:0px 10px;"><input class="subtitles_fll_input_text_subtitle_pos" type="number" min="-100" max="100" step="1" value="'+b.subtitlePosition+
'" style="width:100%; height:25px; border-radius:10px; border:none; text-align:right; background-color:#ddd;"></div></div></div><hr style="border:none; border-bottom:solid 1px #888; margin-top:20px;"><div style="margin:10px;"><div style="margin:0px 10px;">'+k("Playback rate")+'</span></div><div style="display:flex; width:100%;"><div style="flex-grow:1;"><input class="subtitles_fll_input_range_playback" type="range" min="0.1" max="2" step="0.1" value="'+b.video.playbackRate+'" style="width:100%; height:5px; background:#ddd; appearance:none; border-radius:3px; outline:none;"></div><div style="flex-grow:0; width:65px; margin:0px 10px;"><input class="subtitles_fll_input_text_playback" type="number" min="0.1" max="2" step="0.1" value="'+
b.video.playbackRate+'" style="width:100%; height:25px; border-radius:10px; border:none; text-align:right; background-color:#ddd;"></div></div></div><div style="margin:10px;"><div style="margin:0px 10px;">'+k("Video brightness")+'</div><div style="display:flex; width:100%;"><div style="flex-grow:1;"><input class="subtitles_fll_input_range_brightness" type="range" min="0.0" max="4.0" step="0.1" value="'+b.brightness+'" style="width:100%; height:5px; background:#ddd; appearance:none; border-radius:3px; outline:none;"></div><div style="flex-grow:0; width:65px; margin:0px 10px;"><input class="subtitles_fll_input_text_brightness" type="number" min="0.0" max="4.0" step="0.1" value="'+
b.brightness+'" style="width:100%; height:25px; border-radius:10px; border:none; text-align:right; background-color:#ddd;"></div></div></div><div style="margin:10px;"><div style="margin:0px 10px;">'+k("Video contrast")+'</div><div style="display:flex; width:100%;"><div style="flex-grow:1;"><input class="subtitles_fll_input_range_contrast" type="range" min="0.0" max="2.0" step="0.1" value="'+b.contrast+'" style="width:100%; height:5px; background:#ddd; appearance:none; border-radius:3px; outline:none;"></div><div style="flex-grow:0; width:65px; margin:0px 10px;"><input class="subtitles_fll_input_text_contrast" type="number" min="0.0" max="2.0" step="0.1" value="'+
b.contrast+'" style="width:100%; height:25px; border-radius:10px; border:none; text-align:right; background-color:#ddd;"></div></div></div><div style="margin:10px;"><div style="margin:0px 10px;">'+k("Video saturate")+'</div><div style="display:flex; width:100%;"><div style="flex-grow:1;"><input class="subtitles_fll_input_range_saturate" type="range" min="0.0" max="2.0" step="0.1" value="'+b.saturate+'" style="width:100%; height:5px; background:#ddd; appearance:none; border-radius:3px; outline:none;"></div><div style="flex-grow:0; width:65px; margin:0px 10px;"><input class="subtitles_fll_input_text_saturate" type="number" min="0.0" max="2.0" step="0.1" value="'+
b.saturate+'" style="width:100%; height:25px; border-radius:10px; border:none; text-align:right; background-color:#ddd;"></div></div></div><div style="text-align:center; margin-bottom:20px;"><button class="subtitles_fll_reset_button subtitles_fll_bg_color_red" style="width:100px; height:40px; text-align:center; border-radius:20px;">'+k("Reset")+"</button></div></div>",f.insertAdjacentHTML("beforeend",e),b.adjustmentMenuElem=f.getElementsByClassName("subtitles_fll_adjustment_menu_window")[0],f.getElementsByClassName("subtitles_fll_adjustment_menu_close")[0].onclick=
function(d){b.hideAdjustmentMenu()},e=f.getElementsByClassName("subtitles_fll_input_range_subtitle_timing")[0],g=f.getElementsByClassName("subtitles_fll_input_text_subtitle_timing")[0],e.oninput=function(d){b.changeSubtitleTiming(d.target.value)},g.onchange=function(d){b.changeSubtitleTiming(d.target.value)},g.onwheel=function(d){b.changeSubtitleTiming(d.target.value)},e=f.getElementsByClassName("subtitles_fll_input_range_subtitle_pos")[0],g=f.getElementsByClassName("subtitles_fll_input_text_subtitle_pos")[0],
e.oninput=function(d){u(d.target.value)},e.onmousedown=function(d){b.overlaySubtitleContainerElem.style.border="solid 2px #999"},e.onmouseup=function(d){b.overlaySubtitleContainerElem.style.border="none"},g.onchange=function(d){u(d.target.value)},g.onwheel=function(d){u(d.target.value)},e=f.getElementsByClassName("subtitles_fll_input_range_playback")[0],g=f.getElementsByClassName("subtitles_fll_input_text_playback")[0],e.oninput=function(d){b.changePlaybackRate(d.target.value)},g.onchange=function(d){b.changePlaybackRate(d.target.value)},
g.onwheel=function(d){b.changePlaybackRate(d.target.value)},e=f.getElementsByClassName("subtitles_fll_input_range_brightness")[0],g=f.getElementsByClassName("subtitles_fll_input_text_brightness")[0],e.oninput=function(d){b.changeBrightness(d.target.value)},g.onchange=function(d){b.changeBrightness(d.target.value)},g.onwheel=function(d){b.changeBrightness(d.target.value)},e=f.getElementsByClassName("subtitles_fll_input_range_contrast")[0],g=f.getElementsByClassName("subtitles_fll_input_text_contrast")[0],
e.oninput=function(d){b.changeContrast(d.target.value)},g.onchange=function(d){b.changeContrast(d.target.value)},g.onwheel=function(d){b.changeContrast(d.target.value)},e=f.getElementsByClassName("subtitles_fll_input_range_saturate")[0],g=f.getElementsByClassName("subtitles_fll_input_text_saturate")[0],e.oninput=function(d){b.changeSaturate(d.target.value)},g.onchange=function(d){b.changeSaturate(d.target.value)},g.onwheel=function(d){b.changeSaturate(d.target.value)},f.getElementsByClassName("subtitles_fll_reset_button")[0].onclick=
function(d){b.changeSubtitleTiming(b.defaultTiming);b.changeBrightness(1);b.changeContrast(1);b.changeSaturate(1);b.changePlaybackRate(1);u(0)})};this.changeSubtitleTiming=function(f,g){if(!isNaN(Number(f))){f=Number(f);b.timing=f;if(b.adjustmentMenuElem){var c=b.adjustmentMenuElem.getElementsByClassName("subtitles_fll_input_range_subtitle_timing")[0];b.adjustmentMenuElem.getElementsByClassName("subtitles_fll_input_text_subtitle_timing")[0].value=f;c.value=f}b.subtitleTimingDifferenceCallback&&!1!==
g&&b.subtitleTimingDifferenceCallback(f)}};var u=function(f){if(!isNaN(Number(f))){f=Number(f);if(b.adjustmentMenuElem){var g=b.adjustmentMenuElem.getElementsByClassName("subtitles_fll_input_range_subtitle_pos")[0],c=b.adjustmentMenuElem.getElementsByClassName("subtitles_fll_input_text_subtitle_pos")[0];g.value=f;c.value=f}b.subtitlePosition=f;b.refreshSubtitlePosition();b.refreshAmazonSubtitlePosition()}};this.changePlaybackRate=function(f){if(!isNaN(Number(f))){f=Number(f);if(b.adjustmentMenuElem){var g=
b.adjustmentMenuElem.getElementsByClassName("subtitles_fll_input_range_playback")[0],c=b.adjustmentMenuElem.getElementsByClassName("subtitles_fll_input_text_playback")[0];g.value=f;c.value=f}b.video.playbackRate!=f&&(b.video.playbackRate=f)}};this.changeBrightness=function(f){if(!isNaN(Number(f))){f=Number(f);if(b.adjustmentMenuElem){var g=b.adjustmentMenuElem.getElementsByClassName("subtitles_fll_input_range_brightness")[0],c=b.adjustmentMenuElem.getElementsByClassName("subtitles_fll_input_text_brightness")[0];
g.value=f;c.value=f}b.brightness=f;b.video.style.filter="brightness("+b.brightness+") contrast("+b.contrast+") saturate("+b.saturate+")";b.video.style.filter=q()}};this.changeContrast=function(f){if(!isNaN(Number(f))){f=Number(f);if(b.adjustmentMenuElem){var g=b.adjustmentMenuElem.getElementsByClassName("subtitles_fll_input_range_contrast")[0],c=b.adjustmentMenuElem.getElementsByClassName("subtitles_fll_input_text_contrast")[0];g.value=f;c.value=f}b.contrast=f;b.video.style.filter=q()}};this.changeSaturate=
function(f){if(!isNaN(Number(f))){f=Number(f);if(b.adjustmentMenuElem){var g=b.adjustmentMenuElem.getElementsByClassName("subtitles_fll_input_range_saturate")[0],c=b.adjustmentMenuElem.getElementsByClassName("subtitles_fll_input_text_saturate")[0];g.value=f;c.value=f}b.saturate=f;b.video.style.filter=q()}};var q=function(){var f="";1!=b.brightness&&(f+="brightness("+b.brightness+")");1!=b.contrast&&(f+="contrast("+b.contrast+")");1!=b.saturate&&(f+="saturate("+b.saturate+")");return f.trim()};this.hideAdjustmentMenu=
function(){var f=subtitlesForLL.configs;f.subtitlePosition=b.subtitlePosition;f.playbackRate=b.video.playbackRate;f.brightness=b.brightness;f.contrast=b.contrast;f.saturate=b.saturate;chrome.storage.sync.set(f);b.adjustmentMenuElem&&(b.adjustmentMenuElem.style.display="none")};this.adjustmentMenuIsHide=function(){return null==b.adjustmentMenuElem?!0:"none"==b.adjustmentMenuElem.style.display}};function SubtitlesForLLCommentViewer(){};function SubtitlesForLLCommentWindow(){var a=this;this.commentWindowCallback=this.commentWindowElem=this.commentViewerElem=this.commentsOverlayElem=this.commentButton=null;this.comments=[];this.init=function(k){a.commentButton=document.createElement("button");a.commentButton.className="subtitles_fll_comment_button";a.commentButton.style.cssText="position:absolute; top:20px; left:20px; width:40px; height:40px; border-radius:20px; background-color:rgba(200,200,200,0.7);";a.commentButton.onclick=b;a.commentViewerElem=
document.createElement("div");a.commentViewerElem.classList.add("subtitles_fll_comment_viewer");a.commentViewerElem.style.cssText="position:absolute; top:100px; left:0px; width:100%; height:50px; overflow-y:scroll; font-size: 16px;";a.commentCellContainer=document.createElement("div");a.commentCellContainer.classList.add("subtitles_fll_comment_cell_container");a.commentCellContainer.style.cssText="position:relative; width:100%; height:100%;";a.commentViewerElem.insertAdjacentElement("beforeend",a.commentCellContainer)};
this.loadComments=function(k){var n="";a.comments.forEach(function(u){n+='<div class="subtitles_fll_comment_cell" style="position:relative; width:200px; height:100%; margin:0px 10px; margin-right:auto; padding:10px; background-color:#aaa; color:#222; border-radius:15px; white-space:nowrap;"><div style="display:inline-block; margin:5px;"><img style="width:20px; height:20px; border-radius:10px; background-color:#aaa;"></div><div style="display:inline-block; vertical-align:top; width:calc(100% - 30px); white-space:initial;"><div style="display:inline-block;">'+
u.comment+'</div><div><div style="display:inline-block;">\u25cb \u2661</div></div></div></div>'});a.commentCellContainer.innerHTML=n};var b=function(){a.draw()};this.drawCommentWindow=function(){if(!a.commentWindowElem){a.commentWindowElem=document.createElement("div");a.commentWindowElem.className="subtitles_fll_comment_window";a.commentWindowElem.style.cssText="position:absolute; top:100px; left:20px; margin:20px; font-size:18px; z-index:10000;";a.commentWindowElem.innerHTML='<div style="position:relative; width:400px; margin:0px; background-color:rgba(100,100,100,0.8); border-radius:10px;"><div class="subtitles_fll_comment_window_menu" style="width:100%; height:60px;"><div class="subtitles_fll_comment_window_menu_left" style="display:inline-block; width:50%; line-height:100%; text-align:left;"><img style="display:inline-block; width:40px; height:40px; margin:10px; border-radius:20px; background-color:#aaa; vertical-align:middle;"></div><div class="subtitles_fll_comment_window_menu_right" style="display:inline-block; width:50%; line-height:100%; text-align:right;"><button class="subtiltes_fll_comment_window_close" style="display:inline-block; width:40px; height:40px; margin:10px; padding:10px; vertical-align:middle; border-radius:20px; outline:0;"><svg viewBox="0 0 612 612" xmlns="http://www.w3.org/2000/svg"><g><line stroke="#dddddd" stroke-linecap="undefined" stroke-linejoin="undefined" id="svg_1" y2="561.45315" x2="561.49999" y1="48.45311" x1="51.5" stroke-width="99" fill="none"></line><line stroke="#dddddd" stroke-linecap="undefined" stroke-linejoin="undefined" id="svg_2" y2="562" x2="561" y1="50" x1="50" stroke-width="99" fill="none"></line><line transform="rotate(90 305.5,306.00000000000006) " stroke="#dddddd" stroke-linecap="undefined" stroke-linejoin="undefined" id="svg_4" y2="562" x2="561" y1="50" x1="50" stroke-width="99" fill="none"></line></g></svg></button></div></div><textarea class="subtitles_fll_comment_window_comment_textarea" style="width:100%; min-height:60px; border:none; margin:0px; background-color:#999;" placeholder="\u8cea\u554f\u3057\u3066\u307f\u307e\u3057\u3087\u3046"></textarea><div class="subtitles_fll_comment_window_bottom_menu" style="width:100%;"><div class="subtitles_fll_comment_window_bottom_menu_left" style="display:inline-block; width:50%; line-height:100%; text-align:left;"></div><div class="subtitles_fll_comment_window_bottom_menu_right" style="display:inline-block; width:50%; line-height:100%; text-align:right;"><button class="subtitles_fll_bg_color_blue" style="width:100px; height:30px; font-size:16px; margin:10px; border-radius:15px; text-align:center; font-weight:bold;">\u66f8\u304d\u8fbc\u307f</button></div></div></div>';
a.commentWindowElem.querySelector(".subtiltes_fll_comment_window_close").onclick=function(){a.commentWindowElem.remove();a.commentWindowElem=null;a.commentWindowCallback&&a.commentWindowCallback("clickedCloseButton")};var k=a.commentWindowElem.querySelector(".subtitles_fll_comment_window_comment_textarea");k.oninput=function(n){k.style.height="auto";k.style.height=k.scrollHeight+"px"};a.commentButton.parentElement.insertAdjacentElement("beforeend",a.commentWindowElem);k.focus();a.commentWindowCallback&&
a.commentWindowCallback("clickedCommentButton")}};this.comments=[]};window.subtitlesForLL={};subtitlesForLL.SUBTITLE_CONTENTS_VIEW_WIDTH=400;subtitlesForLL.DICTIONARY_BG_ALPHA=.8;subtitlesForLL.SCROLL_BAR_WIDTH=12;subtitlesForLL.USER_WORDS_MAX_COUNT=100;subtitlesForLL.isChromeOSMode=!1;subtitlesForLL.playbackResources={};subtitlesForLL.currentContentId=null;subtitlesForLL.currentCatalogId=null;subtitlesForLL.pageTitle=null;subtitlesForLL.isEnableSubtitleViewer=!1;subtitlesForLL.subtitleViewer=null;
subtitlesForLL.getElementsByTagNameFromAddedNode=function(a,b){var k=[];if(a.nodeType!=Node.ELEMENT_NODE)return k;a.tagName==b.toUpperCase()&&k.push(a);a=a.getElementsByTagName(b);for(b=0;b<a.length;b++)k.push(a[b]);return k};subtitlesForLL.getElementByClassNameFromAddedNode=function(a,b){return a.nodeType!=Node.ELEMENT_NODE?null:a.classList&&a.classList.contains(b)?a:(a=a.getElementsByClassName(b))&&0<a.length?a[0]:null};
subtitlesForLL.getElementsByClassNameFromAddedNode=function(a,b){var k=[];if(a.nodeType!=Node.ELEMENT_NODE)return k;a.classList&&a.classList.contains(b)&&k.push(a);a=a.getElementsByClassName(b);for(b=0;b<a.length;b++)k.push(a[b]);return k};subtitlesForLL.isRightToLeftLanguage=function(a){switch(a){case "ar":case "az":case "ug":case "ur":case "kk":case "ks":case "ky":case "ku":case "sd":case "tt":case "ps":case "pa":case "fa":case "ms":case "yi":case "he":case "dv":return!0;default:return!1}};
(function(){var a=".atvwebplayersdk-overlays-container .f13stccg{padding:0px 20px;}.webPlayerUIContainer{overflow:hidden;}.f1oe4mb3{display:none !important;}.atvwebplayersdk-bottompanel-container{bottom:0px; top:auto; position:absolute; padding-left:20px !important; padding-right:20px !important; height:auto !important; white-space:nowrap; flex-basis:0px; z-index:2;}.atvwebplayersdk-playpause-button, .atvwebplayersdk-fastseekback-button, .atvwebplayersdk-fastseekforward-button{display:none !important;}.pausedOverlay .buttons{display:none !important;}.bottomPanel{position:absolute; bottom:0px;}.bottomPanel .bottomPanelItem{display:block !important;}.persistentPanel span{padding:0px !important;}.persistentPanel div{width:100% !important;}.persistentPanel>div{height:100% !important;}.infoBar .left{min-width:250px;}.nextTitleButton{white-space:nowrap;}div.fk87jrb{position:absolute; top:auto; bottom:0px; height:auto;}div.f1iwgj00>div{width:100% !important; position:static !important; height:auto !important;}.fbhsa9{padding:0px !important;}.atvwebplayersdk-captions-text{padding:0px !important;}.fif0hcs{min-width:auto !important;}.subtitles_fll_fadeout_animation{animation:0.1s ease 0s SubtitleViewerFadeOut;} @keyframes SubtitleViewerFadeOut{0%{opacity:1} 100%{opacity:0}}.subtitles_fll_dark_green_link{background-color:#447567;}.subtitles_fll_dark_green_link:hover{background-color:#75b1a0;}.subtitles_fll_dark_green_link:active{background-color:#ca9060;}#subtitles_fll_input_button_subtitle_url:focus{outline:0;}#subtitles_fll_main_container>*{pointer-events:auto;}#subtitles_fll_contents_view{font-size:13px; user-select:text;}#subtitles_fll_contents_view a{color:#5c85ce;}#subtitles_fll_contents_view button{background-color:#5c85ce;}#subtitles_fll_contents_view button:hover{background-color:#71945e;}#subtitles_fll_contents_view button:active{background-color:#9e486c;}.subtitles_fll_bg_color_red{background-color:#9e486c !important;}.subtitles_fll_bg_color_blue{background-color:#5c85ce; !important;}.subtitles_fll_color_orange{color:#f9bc4b !important;}.subtitles_fll_color_green{color:#35b285 !important;}.subtitles_fll_color_yellow{color:#dbec84 !important;}.subtitles_fll_color_gray{color:#cecece !important;}.subtitles_fll_color_darkgray{color:#999 !important;}.subtitles_fll_hide_animation{transition:all 800ms 0s ease; opacity:0.0;}.subtitles_fll_show_animation{transition:all 200ms 0s ease; opacity:1.0;}.subtitltes_fll_user_word_delete{background-color:#9e486c !important;}.subtitles_fll_settngs_view input, .subtitles_fll_settngs_view select{background-color:#ddd !important;}.subtitles_fll_subtitle_selector_result_detail b{color:#ddd;}.subtitles_fll_search_result_cell:hover{background-color:#181818;}.subtitles_fll_scroll_bar::-webkit-scrollbar{width:"+
subtitlesForLL.SCROLL_BAR_WIDTH+"px;}.subtitles_fll_scroll_bar::-webkit-scrollbar-track{background:#555;}.subtitles_fll_scroll_bar::-webkit-scrollbar-thumb{background:#888; border-radius:"+.5*subtitlesForLL.SCROLL_BAR_WIDTH+"px;}.word_popup_window_scroll_bar::-webkit-scrollbar{width:"+subtitlesForLL.SCROLL_BAR_WIDTH+"px;}.word_popup_window_scroll_bar::-webkit-scrollbar-track{background:#555; border-radius:"+.5*subtitlesForLL.SCROLL_BAR_WIDTH+"px;}.word_popup_window_scroll_bar::-webkit-scrollbar-thumb{background:#888; border-radius:"+
.5*subtitlesForLL.SCROLL_BAR_WIDTH+"px;}#subtitles_fll_word_popup_window{user-select:text}#subtitles_fll_word_popup_window ul{margin:0px; padding:0px; display:block; color:#eee; list-style:inside;}#subtitles_fll_word_popup_window li{margin:0px; padding:0px; display:list-item;}.subtitles_fll_word_popup_window_meaning li::marker{margin:0px;}.subtitles_fll_comment_viewer::-webkit-scrollbar{width:"+subtitlesForLL.SCROLL_BAR_WIDTH+"px;}.subtitles_fll_comment_viewer::-webkit-scrollbar-track{background:rgba(0,0,0,0);}.subtitles_fll_comment_viewer::-webkit-scrollbar-thumb{background:rgba(136,136,136,0.5); border-radius:"+
.5*subtitlesForLL.SCROLL_BAR_WIDTH+"px;}.subtiltes_fll_comment_window_close:hover, .subtitles_fll_word_popup_window_close:hover, .subtitles_fll_adjustment_menu_close:hover{background-color:#777;}.subtiltes_fll_comment_window_close:active, .subtitles_fll_word_popup_window_close:active, .subtitles_fll_adjustment_menu_close:active{background-color:#aaa;}.subtitles_fll_adjust_button:hover{background-color:#555;}#subtitles_fll_overlay_container{user-select:text}.subtitles_fll_overlay_subtitle_cell_container{margin:auto auto 0px auto; pointer-events:auto; text-shadow:1px 1px 3px #000,1px 1px 3px #000,1px 1px 3px #000;}.subtitles_fll_cell{background-color:#222; margin-bottom:5px; padding:10px 5px; position:relative;}.subtitles_fll_cell_subtitle_container{display:inline-block; margin:0px 35px; width:295px; overflow-wrap:anywhere;}.subtitles_fll_cell_seek{position:absolute; width:20px; height:20px; margin:auto 5px; top:0; bottom:0; left:5px; cursor:pointer; user-select:none;}.subtitles_fll_cell_seek img{width:20px; height:20px;}.subtitles_fll_cell_google_translate, .subtitles_fll_cell_deepl_translate{position:absolute; width:15px; height:15px; margin:auto; top:0; bottom:0; right:5px; left:auto; box-sizing:content-box; padding:5px; user-select:none;}.subtitles_fll_cell_deepl_translate{cursor:pointer;}.subtitles_fll_cell_google_translate:hover, .subtitles_fll_cell_deepl_translate:hover{background-color:#555;}.subtitles_fll_cell_google_translate img, .subtitles_fll_cell_deepl_translate img{width:15px; height:15px; pointer-events:none;}.subtitles_fll_cell_deepl_translate{right:25px;}div#learning-level-table span{padding:0px;}div#learning-level-table span.learning-level-content{padding-right:15px;}",
b=function(q){var f={};null==q&&(q=window.location);if(q&&q.search&&0<q.search.length){q=q.search.substring(1).split("&");for(var g=0;g<q.length;g++){var c=q[g].split("=");f[decodeURIComponent(c[0])]=decodeURIComponent(c[1])}}return f}();b.subtitles_for_language_learning&&"enable"==b.subtitles_for_language_learning&&location.pathname.match(/.*\/detail\/.+/mi)&&(subtitlesForLL.isEnableSubtitleViewer=!0);(function(q,f){var g=document.createElement("script");g.src=chrome.extension.getURL(q);g.addEventListener("load",
f,!1);document.getElementsByTagName("html").item(0).prepend(g)})("js/scripts/xml-http-request.js",function(q){});var k=new function(){var q=this,f=subtitlesForLL.getElementByClassNameFromAddedNode,g=subtitlesForLL.getElementsByTagNameFromAddedNode;this.currentVideoElem=this.subtitlePlayerCtrl=null;var c,e,d,m,w;this.init=function(){window.addEventListener("message",function(v){if(v.source==window&&null!=v.data&&"/GetPlaybackResources"==v.data.type){try{var l=JSON.parse(v.data.body);if(null==l)return}catch(r){console.warn("GetPlaybackResources\u306ebody\u3092JSON.parse\u3059\u308b\u306e\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002");
return}if(null==l.returnedTitleRendition||null==l.returnedTitleRendition.contentId)console.warn("amazon\u306e/GetPlaybackResources\u306b\u305f\u3044\u3059\u308b\u30ec\u30b9\u30dd\u30f3\u30b9\u306breturnedTitleRendition\u30ad\u30fc\u304c\u542b\u307e\u308c\u306a\u3044\u30ec\u30b9\u30dd\u30f3\u30b9\u304c\u3042\u308a\u307e\u3057\u305f\u3002(\u60f3\u5b9a\u5916\u306e\u30ec\u30b9\u30dd\u30f3\u30b9)");else{v=l.returnedTitleRendition.contentId;null==subtitlesForLL.playbackResources[v]&&(subtitlesForLL.playbackResources[v]=
{});if(l.catalogMetadata){var h=l.catalogMetadata;h.catalog&&(h.catalog.id&&null==subtitlesForLL.playbackResources[v].catalogId&&(subtitlesForLL.playbackResources[v].catalogId=h.catalog.id),null==subtitlesForLL.playbackResources[v].title&&(h.family&&h.family.tvAncestors&&2<=h.family.tvAncestors.length&&h.family.tvAncestors[1].catalog?subtitlesForLL.playbackResources[v].title=h.family.tvAncestors[1].catalog.title:h.catalog.title&&(subtitlesForLL.playbackResources[v].title=h.catalog.title)),null!=h.catalog.episodeNumber&&
null==subtitlesForLL.playbackResources[v].episodeNumber&&(subtitlesForLL.playbackResources[v].episodeNumber=h.catalog.episodeNumber));h.family&&h.family.tvAncestors&&h.family.tvAncestors[0]&&h.family.tvAncestors[0].catalog&&null!=h.family.tvAncestors[0].catalog.seasonNumber&&null==subtitlesForLL.playbackResources[v].seasonNumber&&(subtitlesForLL.playbackResources[v].seasonNumber=h.family.tvAncestors[0].catalog.seasonNumber)}l.subtitleUrls&&0<=l.subtitleUrls.length&&(null==subtitlesForLL.playbackResources[v]||
null==subtitlesForLL.playbackResources[v].subtitleUrls)&&(subtitlesForLL.playbackResources[v].subtitleUrls=l.subtitleUrls);!l.widevine2License&&null!=l.catalogMetadata||subtitlesForLL.currentContentId==v||(subtitlesForLL.currentContentId=v,subtitlesForLL.currentCatalogId=subtitlesForLL.playbackResources[v].catalogId,t=!0,A())}}});window.addEventListener("beforeunload",function(v){})};this.load=function(){0!=subtitlesForLL.isEnableSubtitleViewer&&("complete"===document.readyState||"interactive"===
document.readyState?D():document.addEventListener("DOMContentLoaded",x,!1))};var x=function(){D()},D=function(){if(c=document.getElementById("dv-web-player"))if(e=c.getElementsByClassName("webPlayerElement").item(0)){var v=e.getElementsByTagName("video");p(v);d=e.getElementsByClassName("atvwebplayersdk-seekbar-range").item(0);null==d&&(d=e.querySelector(".seekBar .positionBar"))&&(subtitlesForLL.isChromeOSMode=!0);m=e.getElementsByClassName("atvwebplayersdk-infobar-container").item(0)||e.getElementsByClassName("infoBar").item(0);
w=e.getElementsByClassName("atvwebplayersdk-playerclose-button").item(0)||e.getElementsByClassName("closeButtonWrapper").item(0)}if(!A()){var l=new MutationObserver(function(h){for(var r=0;r<h.length;r++)for(var z={},B=0;B<h[r].addedNodes.length;z={$jscomp$loop$prop$tmpPosBar$50:z.$jscomp$loop$prop$tmpPosBar$50,$jscomp$loop$prop$seekBarMO$51:z.$jscomp$loop$prop$seekBarMO$51},B++){var E=h[r].addedNodes[B];if(null!=E.classList){null==c&&(c=document.getElementById("dv-web-player"));null==e&&(e=f(E,"webPlayerElement"));
if(e){var G=g(E,"VIDEO");p(G)}e&&null==d&&(d=f(E,"atvwebplayersdk-seekbar-range"),null==d&&(z.$jscomp$loop$prop$tmpPosBar$50=f(E,"positionBar"),z.$jscomp$loop$prop$tmpPosBar$50&&"seekBar"==z.$jscomp$loop$prop$tmpPosBar$50.parentElement.parentElement.className&&(z.$jscomp$loop$prop$seekBarMO$51=new MutationObserver(function(H){return function(y){H.$jscomp$loop$prop$tmpPosBar$50.style.width&&0<H.$jscomp$loop$prop$tmpPosBar$50.style.width.length&&(H.$jscomp$loop$prop$seekBarMO$51.disconnect(),H.$jscomp$loop$prop$seekBarMO$51=
null,d=H.$jscomp$loop$prop$tmpPosBar$50,subtitlesForLL.isChromeOSMode=!0,c&&e&&d&&m&&null==q.subtitlePlayerCtrl&&A())}}(z)),z.$jscomp$loop$prop$seekBarMO$51.observe(z.$jscomp$loop$prop$tmpPosBar$50,{attributes:!0}))));e&&null==m&&(m=f(E,"atvwebplayersdk-infobar-container")||f(E,"infoBar"));c&&null==w&&(w=f(E,"atvwebplayersdk-playerclose-button")||f(E,"closeButtonWrapper"));c&&e&&d&&m&&null==q.subtitlePlayerCtrl&&(l.disconnect(),A())}}});l.observe(document.body,{childList:!0,subtree:!0})}},t=!1,p=
function(v){for(var l=0;l<v.length;l++){var h=v[l];h.addEventListener("loadstart",function(r){C(r)},!1);h.addEventListener("loadedmetadata",C,!1);h.addEventListener("loadeddata",C,!1);h.addEventListener("canplaythrough",C,!1);h.addEventListener("play",C,!1)}},C=function(v){q.currentVideoElem!=v.target&&(q.currentVideoElem=v.target);A()},A=function(){if(!(c&&e&&q.currentVideoElem&&d)||0==t&&q.subtitlePlayerCtrl&&q.currentVideoElem==q.subtitlePlayerCtrl.videoElem)return!1;subtitlesForLL.direction=window.getComputedStyle(e).direction;
null==q.subtitlePlayerCtrl?(q.subtitlePlayerCtrl=new SubtitlesForLLPlayerController,q.subtitlePlayerCtrl.isReceivedNewCatalogId=t,q.subtitlePlayerCtrl.closeCallback=function(){},q.subtitlePlayerCtrl.init(c,e,q.currentVideoElem,d),(new MutationObserver(function(v){v.forEach(function(l){l.addedNodes.forEach(function(h){"VIDEO"==h.tagName&&p([h])})})})).observe(q.currentVideoElem.parentElement,{childList:!0})):(0==q.subtitlePlayerCtrl.isClosed&&t&&q.subtitlePlayerCtrl.close(),q.subtitlePlayerCtrl.videoElem!=
q.currentVideoElem&&q.subtitlePlayerCtrl.changeVideoElem(q.currentVideoElem),t&&q.subtitlePlayerCtrl.setReceivedNewCatalogId(t));t=!1;return!0}};subtitlesForLL.subtitleViewer=k;k.init();chrome.storage.sync.get(function(q){if(null==q||0>=Object.keys(q).length)q=chrome.extension.getURL("install.html"),q+="?ref="+encodeURIComponent(location.href),location.href=q;else{q.userDictionaryRules=q.userDictionaryRules||[];q.subtitleFontSizeVW=q.subtitleFontSizeVW||2.2;q.subtitleScrollViewFontSize=q.subtitleScrollViewFontSize||
20;q.dictionaryFontSize=q.dictionaryFontSize||15;q.dictionaryBackgroundAlpha=q.dictionaryBackgroundAlpha||.8;q.quickBackSec=q.quickBackSec||2;subtitlesForLL.configs=q;subtitlesForLL.userWordsColor={red:"#D44",orange:"#DA6",yellow:"#DD6",green:"#6B6"};subtitlesForLL.userWords=null!=q.userWords&&"string"==typeof q.userWords&&2<q.userWords.length?new Map(JSON.parse(q.userWords)):new Map;subtitlesForLL.amazon=new SubtitlesForLLAmazon;subtitlesForLL.localize=new SubtitlesForLLLocalize(q);if(document.getElementsByTagName("head").item(0))n(document.getElementsByTagName("head").item(0));
else{var f=new MutationObserver(function(c){for(var e=0;e<c.length;e++)for(var d=0;d<c[e].addedNodes.length;d++){var m=c[e].addedNodes[d];if("HEAD"==m.tagName){f.disconnect();f=null;n(m);return}}});f.observe(document,{childList:!0,subtree:!0})}if(document.body)(new SubtitlesForLLAmazonPageChanger(subtitlesForLL.localize)).addSubtitlePlayButton();else{var g=new MutationObserver(function(c){for(var e=0;e<c.length;e++)for(var d=0;d<c[e].addedNodes.length;d++)if("BODY"==c[e].addedNodes[d].tagName){g.disconnect();
g=null;(new SubtitlesForLLAmazonPageChanger(subtitlesForLL.localize)).addSubtitlePlayButton();return}});g.observe(document,{childList:!0,subtree:!0})}"complete"===document.readyState||"interactive"===document.readyState?u():document.addEventListener("DOMContentLoaded",u,!1)}});var n=function(q){var f=document.createElement("style");f.innerText=".subtitles_fll_green_link{background-color:#009a61;}.subtitles_fll_green_link:hover{background-color:#05ab6d;}.subtitles_fll_green_link:active{background-color:#1fce8c;}";
q.insertAdjacentElement("beforeend",f);1==subtitlesForLL.isEnableSubtitleViewer&&(f=document.createElement("style"),f.innerText=a,q.insertAdjacentElement("beforeend",f))},u=function(){1==subtitlesForLL.isEnableSubtitleViewer&&(subtitlesForLL.languageCode=new SubtitlesForLLLanguageCode,subtitlesForLL.common=new SubtitlesForLLCommon,null!=subtitlesForLL.configs&&subtitlesForLL.configs.hideHelpWindow||(new SubtitlesForLLHelpWindow).draw(),k.load())}})();function SubtitlesForLLHelpWindow(){var a=subtitlesForLL.localize.localize;this.draw=function(){var b=chrome.extension.getURL("icons/adjust.svg"),k=document.createElement("div");k.className="subtitleViewer_fll_help_window";k.style.cssText="position:fixed; background-color:rgba(0,0,0,0.3); width:100%; height:100%; top:0; left:0; z-index:100000;";k.innerHTML='<div style="position:relative; text-align:center; width:100%; height:100%; color:#333;"><div style="position:absolute; width:400px; height:230px; background-color:#ddd; border-radius:10px; margin:auto; top:0; bottom:0; left:0; right:0;"><div style="margin: 20px;">Subtitle for Learning Language</div><div style="display:flex; font-size:15px; margin:10px 20px; height:calc(100% - 130px);"><div><img src="'+
b+'" style="width:60px;height:100%;"></div><div style="text-align:left;position: relative;width: 100%;margin: 10px;"><div style="position: absolute;margin: auto;top: 0;bottom: 0;height: 60px;">'+a("HELP_MESSAGE_1")+'</div></div></div><div style="position:absolute; width: calc(100% - 20px); margin: 10px; bottom:0px; text-align:center;"><button class="subtitles_fll_help_ok" style="width: 150px;height:30px;outline:none;border: solid 1px #999;border-radius: 15px;margin: 10px; font-size:0.9vw;">OK</button><button class="subtitles_fll_help_dontshow" style="width: 150px;height:30px;outline:none;border: solid 1px #999;border-radius: 15px;margin: 10px; font-size:0.9vw;">'+
a("Don't show again")+"</button></div></div></div>";k.getElementsByClassName("subtitles_fll_help_ok").item(0).onclick=function(n){k.remove();k=null};k.getElementsByClassName("subtitles_fll_help_dontshow").item(0).onclick=function(n){chrome.storage.sync.set({hideHelpWindow:!0});k.remove();k=null};document.body.insertAdjacentElement("beforeend",k)}};function SubtitlesForLLLocalSubtitle(){var a=this,b=subtitlesForLL.localize.localize,k=[".srt",".vtt",".ass",".ssa"],n=["srt","vtt","ssa","ssa"];this.callback=this.dragArea=this.element=null;this.init=function(){a.element=document.createElement("div");a.element.style.cssText="position:relative; width: calc(100% - 20px); text-align: center; margin: 0px 10px 10px 10px; border-top:1px solid #444;";a.element.innerHTML='<div style="margin:5px 0px;">'+b("If you want to open the subtitle file directly, please open the file from the following.")+
'</div><div class="subtitles_fll_file_drag_area" style="width:100%; border: dotted 2px #999; padding: 10px; border-radius: 20px;"><div>'+b("Drag & Drop Subtitle File Here")+'</div><div style="color:#999;">'+b("Support Files")+' : .srt .vtt .ass .ssa</div><input class="subtitles_fll_file_input" type="file" name="file" accept="'+k.join(",")+'" style="margin-top: 5px; padding:2px 20px; color:#999;"></div>';a.dragArea=a.element.getElementsByClassName("subtitles_fll_file_drag_area").item(0);a.fileInputElem=
a.element.getElementsByClassName("subtitles_fll_file_input").item(0);a.fileInputElem.addEventListener("change",function(f){if(!(null==f.target.files||1>f.target.files.length)){var g=u(f.target.files[0].name);null==g?alert(b("Unsupported file type.")):q(f.target.files[0],g)}});a.dragArea.addEventListener("dragover",function(f){f.stopPropagation();f.preventDefault();a.dragArea.style.background="#888"});a.dragArea.addEventListener("dragleave",function(f){f.stopPropagation();f.preventDefault();a.dragArea.style.background=
null});a.dragArea.addEventListener("drop",function(f){f.stopPropagation();f.preventDefault();a.dragArea.style.background=null;f=f.dataTransfer.files;if(1<f.length)return alert(b("Cannot open multiple files."));var g=u(f[0].name);null==g?alert(b("Unsupported file type.")):q(f[0],g)})};var u=function(f){for(var g=0;g<k.length;g++){var c=f.match(new RegExp(".*\\"+k[g]+"$","im"));if(c&&0<c.length)return n[g]}return null},q=function(f,g){var c=new FileReader;c.onload=function(){a.callback&&a.callback(null,
{filePath:f.name,fileType:g,text:c.result})};c.onerror=function(){a.callback&&a.callback("\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002",{filePath:f.name,fileType:g})};c.readAsText(f)}};function SubtitlesForLLLocalize(a){var b={userRank:{"super admin":{ja:"\u7ba1\u7406\u4eba"},translator:{ja:"\u7ffb\u8a33\u8005"},subtranslator:{ja:"\u526f\u7ffb\u8a33\u8005"},administrator:{ja:"\u7ba1\u7406\u6a29\u9650\u6240\u6709"},moderator:{ja:"\u76e3\u8996\u8005"},"app developer":{ja:"\u30a2\u30d7\u30ea\u958b\u767a\u8005"},trusted:{ja:"\u4fe1\u983c\u3067\u304d\u308b\u30e6\u30fc\u30b6\u30fc"},warning:{ja:"\u8981\u6ce8\u610f"},"platinum member":{ja:"\u516c\u958b\u65701001\u4ee5\u4e0a",default:"Uploads 1001-"},
"gold member":{ja:"\u516c\u958b\u6570101\u301c1000",default:"Uploads 101-1000"},"silver member":{ja:"\u516c\u958b\u657051\u301c100",default:"Uploads 51-100"},"bronze member":{ja:"\u516c\u958b\u65701\u301c50",default:"Uploads 1-50"}},Search:{ja:"\u691c\u7d22"},Season:{ja:"\u30b7\u30fc\u30ba\u30f3"},Episode:{ja:"\u30a8\u30d4\u30bd\u30fc\u30c9"},Score:{ja:"\u30b9\u30b3\u30a2"},Download:{ja:"\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9"},Language:{ja:"\u8a00\u8a9e"},File:{ja:"\u30d5\u30a1\u30a4\u30eb"},"If you want to open the subtitle file directly, please open the file from the following.":{ja:"\u5b57\u5e55\u30d5\u30a1\u30a4\u30eb\u3092\u76f4\u63a5\u958b\u304f\u5834\u5408\u306f\u3001\u4e0b\u8a18\u304b\u3089\u958b\u3044\u3066\u304f\u3060\u3055\u3044\u3002"},
"Drag & Drop Subtitle File Here":{ja:"\u5b57\u5e55\u30d5\u30a1\u30a4\u30eb\u3092\u30c9\u30e9\u30c3\u30b0&\u30c9\u30ed\u30c3\u30d7\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},"Support Files":{ja:"\u5bfe\u5fdc\u30d5\u30a1\u30a4\u30eb"},"Unsupported file type.":{ja:"\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u306a\u3044\u7a2e\u985e\u306e\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002"},"Cannot open multiple files.":{ja:"\u8907\u6570\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002"},
Subtitle:{ja:"\u5b57\u5e55"},"Subtitle search":{ja:"\u5b57\u5e55\u691c\u7d22"},Settings:{ja:"\u8a2d\u5b9a"},Words:{ja:"\u30ef\u30fc\u30c9"},"Please enter the ENGLISH TITLE on Search Tab and search.":{ja:"\u691c\u7d22\u30bf\u30d6\u3067\u82f1\u984c\u3092\u5165\u529b\u3057\u3001\u5b57\u5e55\u3092\u691c\u7d22\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},Encoding:{ja:"\u6587\u5b57\u30a8\u30f3\u30b3\u30fc\u30c9"},"Tokenizing...":{ja:"\u5b57\u5e55\u306e\u89e3\u6790\u4e2d..."},USER_WORDS_DESCRIPTION:{ja:"\u767b\u9332\u3057\u305f\u5358\u8a9e\u306e\u8868\u793a\u8272\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002",
default:"You can change the display color of the registered words."},Word:{ja:"\u30ef\u30fc\u30c9"},Color:{ja:"\u8272"},Regex:{ja:"\u6b63\u898f\u8868\u73fe"},Add:{ja:"\u8ffd\u52a0"},"Waiting for PlaybackResource to be received...":{ja:"\u30d3\u30c7\u30aa\u60c5\u5831\u3092\u53d7\u4fe1\u3059\u308b\u306e\u3092\u5f85\u3063\u3066\u3044\u307e\u3059..."},"initializing...":{ja:"\u521d\u671f\u5316\u4e2d..."},"Waiting for video to load start...":{ja:"\u52d5\u753b\u306e\u30ed\u30fc\u30c9\u304c\u958b\u59cb\u3055\u308c\u308b\u306e\u3092\u5f85\u3063\u3066\u3044\u307e\u3059\u3002"},
"Waiting for video to be loaded...":{ja:"\u52d5\u753b\u304c\u8aad\u307f\u8fbc\u307e\u308c\u308b\u306e\u3092\u5f85\u3063\u3066\u3044\u307e\u3059..."},"Getting video information...":{ja:"\u52d5\u753b\u60c5\u5831\u3092\u53d6\u5f97\u4e2d\u3067\u3059..."},"Please enter a title":{ja:"\u82f1\u8a9e\u306e\u539f\u984c\u3067\u691c\u7d22\u3057\u3066\u304f\u3060\u3055\u3044",default:"Enter keywords(English)"},"No results found.":{ja:"\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002"},"No results found for ":{ja:"\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u691c\u7d22\u30ef\u30fc\u30c9 : "},
"Results for ":{ja:"\u691c\u7d22 : "},"Other users are watching with such subtitles":{ja:"\u4ed6\u306e\u30e6\u30fc\u30b6\u30fc\u306f\u3053\u3093\u306a\u5b57\u5e55\u3068\u4e00\u7dd2\u306b\u898b\u3066\u3044\u307e\u3059\u3002"},"Searching for subtitles...":{ja:"\u5b57\u5e55\u3092\u691c\u7d22\u4e2d\u3067\u3059..."},"OpenSubtitles.org returned an error.":{ja:"OpenSubtitles.org\u3067\u30a8\u30e9\u30fc\u304c\u8d77\u304d\u307e\u3057\u305f\u3002"},ERROR:{ja:"\u30a8\u30e9\u30fc"},"Downloading...":{ja:"\u5b57\u5e55\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u4e2d\u3067\u3059..."},
"Search other subtitles of same movie":{ja:"\u3053\u306e\u4f5c\u54c1\u306e\u3001\u4ed6\u306e\u5b57\u5e55\u3092\u691c\u7d22"},AUTO_IMDB_SEARCH_MSG_1:{ja:"",default:"Searching for "},AUTO_IMDB_SEARCH_MSG_2:{ja:"<br>\u306e\u5b57\u5e55\u3092\u81ea\u52d5\u691c\u7d22\u4e2d\u3067\u3059...",default:""},USER_COUNT_PREFIX:{ja:"",default:""},USER_COUNT_SUFFIX:{ja:"\u4eba\u306e\u30e6\u30fc\u30b6\u30fc\u304c\u3053\u306e\u5b57\u5e55\u3067\u5b66\u7fd2\u3057\u307e\u3057\u305f\u3002",default:" Users leaned with this subtitle."},
"Google Translate":{ja:"Google\u7ffb\u8a33"},"Turn OFF":{ja:"\u30aa\u30d5\u306b\u3059\u308b"},"Turn ON":{ja:"\u30aa\u30f3\u306b\u3059\u308b"},SETTINGS_MESSAGE:{ja:"\u8a2d\u5b9a\u3092\u53cd\u6620\u3059\u308b\u306b\u306f\u3001\u753b\u9762\u4e0b\u90e8\u306e\u300c\u4fdd\u5b58\u30dc\u30bf\u30f3\u300d\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044",default:'Press the "Save" button at the bottom of the screen to reflect the settings.'},"Subtitle timing":{ja:"\u5b57\u5e55\u8868\u793a\u30bf\u30a4\u30df\u30f3\u30b0\u8abf\u6574"},
"Playback rate":{ja:"\u518d\u751f\u901f\u5ea6(\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u30ad\u30fc\uff1aS,F or &lt;,&gt;)",default:"Playback rate(Key S,F or &lt;,&gt;)"},"Video brightness":{ja:"\u30d3\u30c7\u30aa\u660e\u308b\u3055"},"Video contrast":{ja:"\u30d3\u30c7\u30aa\u30b3\u30f3\u30c8\u30e9\u30b9\u30c8"},"Video saturate":{ja:"\u30d3\u30c7\u30aa\u5f69\u5ea6"},"Subtitle position":{ja:"\u5b57\u5e55\u8868\u793a\u4f4d\u7f6e"},"Your Amazon":{ja:"\u5229\u7528\u3059\u308bAmazon"},"Native language":{ja:"\u3042\u306a\u305f\u306e\u8a00\u8a9e"},
"Learning language":{ja:"\u5b66\u7fd2\u3059\u308b\u8a00\u8a9e"},"Subtitle font-size (Window ratio)":{ja:"\u5b57\u5e55\u30d5\u30a9\u30f3\u30c8\u30b5\u30a4\u30ba(\u30a6\u30a3\u30f3\u30c9\u30a6\u6bd4\u7387)"},"Subtitles view font-size (px)":{ja:"\u5b57\u5e55\u4e00\u89a7\u30d5\u30a9\u30f3\u30c8\u30b5\u30a4\u30ba(px)"},"Dictionary font-size (px)":{ja:"\u8f9e\u66f8\u30d5\u30a9\u30f3\u30c8\u30b5\u30a4\u30ba(px)"},"Dictionary Popup background-alpha":{ja:"\u8f9e\u66f8\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u80cc\u666f\u900f\u660e\u5ea6"},
"User dictionary link settings":{ja:"\u30e6\u30fc\u30b6\u30fc\u8f9e\u66f8\u30ea\u30f3\u30af\u8a2d\u5b9a"},"Subtitle files cache":{ja:"\u5b57\u5e55\u30d5\u30a1\u30a4\u30eb\u30ad\u30e3\u30c3\u30b7\u30e5"},ALLOW_TRANSMISSION_MESSAGE:{ja:"\u533f\u540d\u3067\u52d5\u753b\u3001\u5b57\u5e55\u306e\u60c5\u5831\u3092\u30b5\u30fc\u30d0\u30fc\u306b\u9001\u4fe1\u3059\u308b\u4e8b\u3092\u8a31\u53ef\u3059\u308b"},ALLOW_TRANSMISSION_WARNING:{ja:"\u7121\u52b9\u306b\u3059\u308b\u3068\u81ea\u52d5\u3067\u306e\u5b57\u5e55\u691c\u7d22\u3001\u5b57\u5e55\u306e\u81ea\u52d5\u30bf\u30a4\u30df\u30f3\u30b0\u8abf\u6574\u304c\u7121\u52b9\u306b\u306a\u308a\u307e\u3059"},
"Enable automatic subtitle display timing adjustment.(some videos)":{ja:"\u81ea\u52d5\u5b57\u5e55\u8868\u793a\u30bf\u30a4\u30df\u30f3\u30b0\u3092\u6709\u52b9\u306b\u3059\u308b(\u4e00\u90e8\u306e\u4f5c\u54c1)"},"Quick back sec (Shortcut key = R)":{ja:"\u30af\u30a4\u30c3\u30af\u30d0\u30c3\u30af\u79d2\u6570(R\u30ad\u30fc)"},Delete:{ja:"\u524a\u9664"},Save:{ja:"\u4fdd\u5b58"},"Shortcut keys":{ja:"\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u30ad\u30fc"},"Playback rate UP : F or &gt;":{ja:"\u518d\u751f\u901f\u5ea6\u30a2\u30c3\u30d7 : F or &gt"},
"Playback rate DOWN : S or &lt;":{ja:"\u518d\u751f\u901f\u5ea6\u30c0\u30a6\u30f3 : S or &lt"},"Seek to prev subtitle position : E":{ja:"\u524d\u306e\u5b57\u5e55\u306e\u518d\u751f\u4f4d\u7f6e\u306b\u30b7\u30fc\u30af : E",default:"Seek to prev subtitle : E"},"Seek to next subtitle position : D":{ja:"\u6b21\u306e\u5b57\u5e55\u306e\u518d\u751f\u4f4d\u7f6e\u306b\u30b7\u30fc\u30af : D",default:"Seek to next subtitle : D"},"Quick back : R":{ja:"\u30af\u30a4\u30c3\u30af\u30d0\u30c3\u30af : R"},"Playback or Pause : Space":{ja:"\u518d\u751f or \u4e00\u6642\u505c\u6b62 : \u30b9\u30da\u30fc\u30b9\u30ad\u30fc"},
"You can not select the same language.":{ja:"\u300c\u3042\u306a\u305f\u306e\u8a00\u8a9e\u300d\u3068\u300c\u5b66\u7fd2\u3059\u308b\u8a00\u8a9e\u300d\u3067\u540c\u3058\u8a00\u8a9e\u3092\u9078\u629e\u3059\u308b\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002"},"Connection error":{ja:"\u63a5\u7d9a\u30a8\u30e9\u30fc"},noun:{ja:"\u540d\u8a5e"},verb:{ja:"\u52d5\u8a5e"},adjective:{ja:"\u5f62\u5bb9\u8a5e"},adverb:{ja:"\u526f\u8a5e"},conjunction:{ja:"\u63a5\u7d9a\u8a5e"},preposition:{ja:"\u524d\u7f6e\u8a5e"},
pronoun:{ja:"\u4ee3\u540d\u8a5e"},particle:{ja:"\u52a9\u8a5e"},interjection:{ja:"\u9593\u6295\u8a5e"},article:{ja:"\u51a0\u8a5e"},"auxiliary verb":{ja:"\u52a9\u52d5\u8a5e"},Synonyms:{ja:"\u540c\u7fa9\u8a9e",th:"\u0e04\u0e33\u0e1e\u0e49\u0e2d\u0e07\u0e04\u0e27\u0e32\u0e21\u0e2b\u0e21\u0e32\u0e22"},Classifiers:{ja:"\u5206\u985e\u5b50",th:"\u0e08\u0e31\u0e14\u0e01\u0e25\u0e38\u0e48\u0e21"},Antonyms:{ja:"\u5bfe\u7fa9\u8a9e",th:"\u0e04\u0e33\u0e15\u0e23\u0e07\u0e02\u0e49\u0e32\u0e21"},Example:{ja:"\u4f8b",
th:"\u0e15\u0e31\u0e27\u0e2d\u0e22\u0e48\u0e32\u0e07"},Definitions:{ja:"\u5b9a\u7fa9",th:"\u0e04\u0e33\u0e08\u0e33\u0e01\u0e31\u0e14\u0e04\u0e27\u0e32\u0e21"},"Now Loading...":{ja:"\u8aad\u8fbc\u4e2d\u3067\u3059..."},"No results":{ja:"\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f"},"Don't show again":{ja:"\u6b21\u56de\u304b\u3089\u306f\u8868\u793a\u3057\u306a\u3044"},HELP_MESSAGE_1:{ja:"\u5b57\u5e55\u8868\u793a\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3001\u8868\u793a\u4f4d\u7f6e\u306e\u8abf\u6574\u306f\u753b\u9762\u4e0b\u90e8\u306e\u30a2\u30a4\u30b3\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u3002",
default:"\u5b57\u5e55\u8868\u793a\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3001\u8868\u793a\u4f4d\u7f6e\u306e\u8abf\u6574\u306f\u753b\u9762\u4e0b\u90e8\u306e\u30a2\u30a4\u30b3\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},"Could not download subtitles.":{ja:"\u5b57\u5e55\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u51fa\u6765\u307e\u305b\u3093\u3067\u3057\u305f\u3002"},ERROR_503:{ja:"\u300chttps://www.opensubtitles.org/\u300d\u306e\u30b5\u30fc\u30d0\u30fc\u304c\u73fe\u5728\u5229\u7528\u3067\u304d\u306a\u3044\u72b6\u614b\u3067\u3059\u3002\u3057\u3070\u3089\u304f\u6642\u9593\u3092\u304a\u3044\u3066\u304b\u3089\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002(503)",
default:"The https://www.opensubtitles.org/ server is currently unavailable. Please wait for a while before trying.(503)"}};this.localize=function(k,n){if(a&&n&&b[n]&&b[n][k]){if(null!=b[n][k][a.nativeLanguage])return b[n][k][a.nativeLanguage];if(null!=b[n][k]["default"])return b[n][k]["default"]}else if(a&&b[k]){if(null!=b[k][a.nativeLanguage])return b[k][a.nativeLanguage];if(null!=b[k]["default"])return b[k]["default"]}return k}};function SubtitlesForLLOpenSubtitlesOrg(){this.search=function(a,b,k){var n=subtitlesForLL.languageCode.toOpensubtitlesOrgLangCode(b);null==n?console.warn("\u5b66\u7fd2\u3059\u308b\u8a00\u8a9e\u306e\u30b3\u30fc\u30c9\u3092opensubtitles.org\u306esublanguageid\u306b\u5909\u63db\u51fa\u6765\u307e\u305b\u3093(\u60f3\u5b9a\u5916) lang="+b):a.sublanguageid=n;b=Object.keys(a);b.sort();n="https://rest.opensubtitles.org/search";for(var u=0;u<b.length;u++)n+="/"+b[u]+"-"+encodeURIComponent(a[b[u]]);var q=chrome.extension.connect({name:"Subtitles for Language Learning (Prime Video)"});
q.onMessage.addListener(function(f){q.disconnect();var g=q=null;if(200==f.status){var c=f.responseText;if(null!=c&&0<c.length)try{g=JSON.parse(f.responseText)}catch(e){k(null,f);return}}k(g,f)});q.postMessage({type:"searchOpenSubtitlesOrgAPI",url:n})}};function SubtitlesForLLSettingsView(){function a(q,f){q='<select name="'+q+'" style="display:inline-block; width:100%; height:35px; border-radius:20px; padding:0px 10px; font-size:14px; border:none; outline:none;">';for(var g=Object.keys(subtitlesForLL.languageCode.codes),c=0;c<g.length;c++)q=f==g[c]?q+('<option value="'+g[c]+'" selected="selected">'+subtitlesForLL.languageCode.codes[g[c]].enName+" ("+subtitlesForLL.languageCode.codes[g[c]].nativeName+")</option>"):q+('<option value="'+g[c]+'">'+
subtitlesForLL.languageCode.codes[g[c]].enName+" ("+subtitlesForLL.languageCode.codes[g[c]].nativeName+")</option>");return q+"</select>"}function b(q){var f='<select name="amazonHostname" style="display:inline-block; width:100%; height:35px; border-radius:20px; padding:0px 10px; font-size:14px; border:none; outline:none;">';subtitlesForLL.amazon.hostnames.forEach(function(g,c){f=q==g.hostname?f+('<option value="'+g.hostname+'" selected="selected">'+g.country+" - "+g.hostname+(g.hostname!=g.primeHostname?
" ("+g.primeHostname+")":"")+"</option>"):f+('<option value="'+g.hostname+'">'+g.country+" - "+g.hostname+(g.hostname!=g.primeHostname?" ("+g.primeHostname+")":"")+"</option>")});return f+="</select>"}var k=this,n=subtitlesForLL.localize.localize;this.element=null;this.init=function(){k.element=document.createElement("div");k.element.className="subtitles_fll_settngs_view";k.element.style.cssText="color:#ddd; font-size:14px; overflow-y:scroll; height:calc(100% - 40px);";var q=chrome.extension.getURL("/license.html");
q='<div style="padding: 20px; border-bottom: 1px solid #999;">'+n("SETTINGS_MESSAGE")+'</div><div style=""><div class="amazon_hostname_selector" style="display:flex; height:100%; align-items:center; margin: 20px;"><div style="width:40%;">'+n("Your Amazon")+'</div><div style="width:60%;">'+b(subtitlesForLL.configs.amazonRegion)+'</div></div></div><div style=""><div class="native_language_selector" style="display:flex; height:100%; align-items:center; margin: 20px;"><div style="width:40%;">'+n("Native language")+
'</div><div style="width:60%;">'+a("nativeLanguage",subtitlesForLL.configs.nativeLanguage)+'</div></div><div class="learning_language_selector" style="display:flex; height:100%; align-items:center; margin: 20px;"><div style="width:40%;">'+n("Learning language")+'</div><div style="width:60%;">'+a("learningLanguage",subtitlesForLL.configs.learningLanguage)+'</div></div></div><div class="subtitles_fll_configs_subtitle_size" style="margin:20px; display:flex; align-items:center;">'+n("Subtitle font-size (Window ratio)")+
'<div style="margin-right:0px; margin-left:auto;"><input type="number" value="'+subtitlesForLL.configs.subtitleFontSizeVW+'" min="1.5" max="5.0" step="0.1" style="width:60px; height:35px; border-radius:20px; text-align:right; padding:0px 10px; border:none; outline:none;"></div></div><div class="subtitles_fll_configs_subtitles_view_size" style="margin:20px; display:flex; align-items:center;">'+n("Subtitles view font-size (px)")+'<div style="margin-right:0px; margin-left:auto;"><input type="number" value="'+
subtitlesForLL.configs.subtitleScrollViewFontSize+'" min="5" style="width:60px; height:35px; border-radius:20px; text-align:right; padding:0px 10px; border:none; outline:none;"></div></div><div class="subtitles_fll_configs_dict_size" style="margin:20px; display:flex; align-items:center;">'+n("Dictionary font-size (px)")+'<div style="margin-right:0px; margin-left:auto;"><input type="number" value="'+subtitlesForLL.configs.dictionaryFontSize+'" min="5" style="width:60px; height:35px; border-radius:20px; text-align:right; padding:0px 10px; border:none; outline:none;"></div></div><div class="subtitles_fll_configs_dict_bg_alpha" style="margin:20px; display:flex; align-items:center;">'+
n("Dictionary Popup background-alpha")+'<div style="margin-right:0px; margin-left:auto;"><input type="number" value="'+subtitlesForLL.configs.dictionaryBackgroundAlpha+'" min="0.1" max="1" step="0.1" style="width:60px; height:35px; border-radius:20px; text-align:right; padding:0px 10px; border:none; outline:none;"></div></div><div class="subtitles_fll_user_dict" style="margin:20px; white-space:nowrap;"><div>'+n("User dictionary link settings")+'</div><div style="margin-left:auto; margin-right:0px;" class="subtitles_fll_dictionary_container"></div></div><div><div style="margin:20px;"><input class="subtitles_fll_configs_timing_input" type="checkbox"'+
(!1!==subtitlesForLL.configs.enableAutoSubtitleTimingAdjustment?" checked":"")+">"+n("Enable automatic subtitle display timing adjustment.(some videos)")+'</div></div><div class="subtitles_fll_quick_back" style="margin:20px; display:flex; align-items:center;">'+n("Quick back sec (Shortcut key = R)")+'<div style="margin-right:0px; margin-left:auto;"><input type="number" value="'+subtitlesForLL.configs.quickBackSec+'" min="1" max="10" step="0.1" style="width:60px; height:35px; border-radius:20px; text-align:right; padding:0px 10px; border:none; outline:none;"></div></div><div style="margin:20px; display:flex; align-items:center;">'+
n("Subtitle files cache")+'<div style="margin-right:0px; margin-left:auto;"><button class="subtitles_fll_configs_delete_button subtitles_fll_bg_color_red" style="width:80px; height:35px; text-align:center; border-radius:20px;"">'+n("Delete")+'</button></div></div><div style="text-align:center; margin:20px;"><button class="subtitles_fll_configs_save_button" style="width:150px; height:35px; text-align:center; border-radius:20px;">'+n("Save")+'</button></div><div style="margin:20px;"><div>'+n("Shortcut keys")+
'</div><div style="text-align:right; direction:ltr;">'+n("Playback rate UP : F or &gt;")+'</div><div style="text-align:right; direction:ltr;">'+n("Playback rate DOWN : S or &lt;")+'</div><div style="text-align:right; direction:ltr;">'+n("Seek to prev subtitle position : E")+'</div><div style="text-align:right; direction:ltr;">'+n("Seek to next subtitle position : D")+'</div><div style="text-align:right; direction:ltr;">'+n("Quick back : R")+'</div><div style="text-align:right; direction:ltr;">'+n("Playback or Pause : Space")+
'</div></div><div><div style="text-align:center; margin-bottom:20px;"><a href="'+q+'" target="_blank">License</a></div></div>';k.element.innerHTML=q;q=document.getElementsByClassName("webPlayerElement").item(0);if("rtl"==window.getComputedStyle(q).direction){q=k.element.getElementsByTagName("div");for(var f=0;f<q.length;f++){var g=q[f];"0px"==g.style.marginRight&&"auto"==g.style.marginLeft&&(g.style.marginRight="auto",g.style.marginLeft="0px")}}u(subtitlesForLL.configs.learningLanguage,subtitlesForLL.configs.nativeLanguage);
var c=k.element.getElementsByClassName("native_language_selector").item(0).getElementsByTagName("select").item(0),e=k.element.getElementsByClassName("learning_language_selector").item(0).getElementsByTagName("select").item(0);c.onchange=function(d){u(e.value,c.value)};e.onchange=function(d){u(e.value,c.value)};k.element.getElementsByClassName("subtitles_fll_configs_delete_button")[0].onclick=function(d){var m=chrome.extension.connect({name:"Subtitles for Language Learning (Prime Video)"});m.onMessage.addListener(function(w){m.disconnect();
m=null});m.postMessage({type:"removeAllFiles"});alert("\u524a\u9664\u3057\u307e\u3057\u305f\u3002")};k.element.getElementsByClassName("subtitles_fll_configs_save_button")[0].onclick=function(d){d={};var m=k.element.getElementsByClassName("amazon_hostname_selector")[0].getElementsByTagName("select")[0];d.amazonRegion=m.value;m=k.element.getElementsByClassName("native_language_selector")[0].getElementsByTagName("select")[0];d.nativeLanguage=m.value;m=k.element.getElementsByClassName("learning_language_selector")[0].getElementsByTagName("select")[0];
d.learningLanguage=m.value;if(d.nativeLanguage==d.learningLanguage)alert(n("You can not select the same language."));else if(m=k.element.getElementsByClassName("subtitles_fll_configs_subtitle_size")[0].getElementsByTagName("input")[0],d.subtitleFontSizeVW=Number(m.value),m=k.element.getElementsByClassName("subtitles_fll_configs_subtitles_view_size")[0].getElementsByTagName("input")[0],5>Number(m.value))alert("\u30d5\u30a9\u30f3\u30c8\u30b5\u30a4\u30ba\u304c\u5c0f\u3055\u3059\u304e\u307e\u3059\u3002");
else if(d.subtitleScrollViewFontSize=Number(m.value),m=k.element.getElementsByClassName("subtitles_fll_configs_dict_size")[0].getElementsByTagName("input")[0],5>Number(m.value))alert("\u30d5\u30a9\u30f3\u30c8\u30b5\u30a4\u30ba\u304c\u5c0f\u3055\u3059\u304e\u307e\u3059\u3002");else{d.dictionaryFontSize=Number(m.value);m=k.element.querySelector(".subtitles_fll_configs_dict_bg_alpha input");d.dictionaryBackgroundAlpha=Number(m.value);m=k.element.querySelector(".subtitles_fll_quick_back input");d.quickBackSec=
Number(m.value);k.element.getElementsByClassName("subtitles_fll_user_dic_textarea").item(0);var w=k.element.getElementsByClassName("subtitles_fll_user_dic_cell");m=[];for(var x=0;x<w.length;x++){var D=w[x],t=D.getElementsByClassName("subtitles_fll_user_dic_name").item(0);D=D.getElementsByClassName("subtitles_fll_user_dic_url").item(0);0==t.value.length&&0==D.value.length||m.push({name:subtitlesForLL.common.escapeHTML(0>=t.value.length?" ":t.value),url:encodeURI(D.value)})}w=null==subtitlesForLL.configs.userDictionaryRules||
null==subtitlesForLL.configs.userDictionaryRules[d.learningLanguage]||null==subtitlesForLL.configs.userDictionaryRules[d.learningLanguage][d.nativeLanguage]?subtitlesForLL.common.getDefaultDictionaryRules(d.learningLanguage,d.nativeLanguage):subtitlesForLL.configs.userDictionaryRules[d.learningLanguage][d.nativeLanguage];x=!1;if(m.length==w.length)for(t=0;t<m.length;t++){if(m[t].name!=w[t].name||m[t].url!=w[t].url){x=!0;break}}else x=!0;x&&(null==d.userDictionaryRules&&(d.userDictionaryRules={}),
null==d.userDictionaryRules[d.learningLanguage]&&(d.userDictionaryRules[d.learningLanguage]={}),d.userDictionaryRules[d.learningLanguage][d.nativeLanguage]=m);m=k.element.getElementsByClassName("subtitles_fll_configs_timing_input").item(0);d.enableAutoSubtitleTimingAdjustment=m.checked;m=subtitlesForLL.configs.nativeLanguage;w=subtitlesForLL.configs.learningLanguage;chrome.storage.sync.set(d);subtitlesForLL.configs=Object.assign(subtitlesForLL.configs,d);if(m!=d.nativeLanguage||w!=d.learningLanguage){var p=
chrome.extension.connect({name:"Subtitles for Language Learning (Prime Video)"});p.onMessage.addListener(function(){p.disconnect();p=null});p.postMessage({type:"setupDictionary"});location.reload()}else{document.getElementsByClassName("subtitles_fll_overlay_subtitle_container")[0].style.fontSize=d.subtitleFontSizeVW+"vw";if(m=document.getElementsByClassName("subtitles_fll_subtitles_container").item(0))m.style.fontSize=d.subtitleScrollViewFontSize+"px";u(d.learningLanguage,d.nativeLanguage);alert("\u4fdd\u5b58\u3057\u307e\u3057\u305f\u3002")}}}};
this.close=function(){k.element.remove();k.element.innerHTML=null;k.element=null};var u=function(q,f){var g=k.element.getElementsByClassName("subtitles_fll_dictionary_container").item(0);g.style.cssText="font-size:13px;";var c="";q=subtitlesForLL.configs.userDictionaryRules&&subtitlesForLL.configs.userDictionaryRules[q]&&subtitlesForLL.configs.userDictionaryRules[q][f]?subtitlesForLL.configs.userDictionaryRules[q][f]:subtitlesForLL.common.getDefaultDictionaryRules(q,f);for(f=0;f<q.length+1;f++){var e=
f<q.length?q[f]:{name:"",url:""};c+='<div class="subtitles_fll_user_dic_cell" style="display:flex; margin:10px 0px 10px 10px;"><div style="width:110px;">Name<input type="text" class="subtitles_fll_user_dic_name" value="'+e.name+'" name="name" style="width:60px; height:30px; margin:0px 5px; padding:0px 5px; border-radius:15px; border:none;"></div><div style="width:calc(100% - 100px); text-align:right;">URL<input type="text" class="subtitles_fll_user_dic_url" value="'+e.url+'" name="url" style="width:200px; height:30px; margin:0px 0px 0px 5px; padding:0px 5px; border-radius:15px; border:none;"></div></div>'}g.innerHTML=
c}};function SubtitlesForLLContentsView(){var a=this,b=subtitlesForLL.localize.localize;this.subtitles=this.originalSubtitleType=this.originalSubtitleStr=this.amazonUIChanger=this.videoElem=this.currentCatalogId=this.subtitleSettings=this.subtitleCallback=this.clickSeekButtonCallback=this.mouseUpCallback=this.clickCallback=this.mouseLeaveCallback=this.mouseEnterCallback=null;this.currentSubtitleIndex=-1;this.activeSubtitleElems=[];this.subtitleSelector=this.overlaySubtitleElem=this.readPositionSubtitleElem=
null;this.element=document.createElement("div");this.element.id="subtitles_fll_contents_view";this.element.style.cssText="background-color:#222; border-left: solid 1px #444444; width:400px; min-width:400px; max-width:400px; height:100%; z-index:10000; position:absolute; top:0px; right:0px; pointer-events:auto;";this.wordSeparater=this.usageSubtitleInfo=this.subtitlesContainer=this.encodingMenuElem=this.subtitlesTabMsgContainer=this.loadingElem=null;var k,n=null,u=0;this.changeVideoElem=function(l){a.videoElem=
l};this.init=function(l){a.videoElem=l;document.getElementsByClassName("webPlayerElement").item(0);subtitlesForLL.isRightToLeftLanguage(subtitlesForLL.configs.learningLanguage)&&(a.element.style.right=null,a.element.style.left="0px");l='<div class="subtitles_fll_menus" style="display:flex; background-color:#222222; font-size:14px; color:#ffffff; width:100%; height:40px; margin:0px;"><div class="subtitles_fll_menu_button" style="background-color:#000000; border-right:solid 1px #444444; padding:0px 10px 0px 10px; width:80px; height:100%; margin:0px; text-align:center; display:flex; align-items:center; justify-content:center; cursor:pointer;">'+
b("Subtitle")+'</div><div class="subtitles_fll_menu_button" style="background-color:#000000; border-right:solid 1px #444444; padding:0px 10px 0px 10px; width:80px; height:100%; margin:0px; text-align:center; display:flex; align-items:center; justify-content:center; cursor:pointer;">'+b("Search")+'</div><div class="subtitles_fll_menu_button" style="background-color:#000000; border-right:solid 1px #444444; padding:0px 10px 0px 10px; width:80px; height:100%; margin:0px; text-align:center; display:flex; align-items:center; justify-content:center; cursor:pointer;">'+
b("Settings")+'</div><div class="subtitles_fll_menu_button" style="background-color:#000000; border-right:solid 1px #444444; padding:0px 10px 0px 10px; width:80px; height:100%; margin:0px; text-align:center; display:flex; align-items:center; justify-content:center; cursor:pointer;">'+b("Words")+"</div></div>";a.element.innerHTML=l;l=a.element.getElementsByClassName("subtitles_fll_menu_button");for(var h=0;h<l.length;h++)l[h].onclick=w;a.subtitleSelector=new SubtitlesForLLSubtitleSelector;a.subtitleSelector.init();
a.subtitleSelector.showLoadingView(b("initializing..."));a.subtitleSelector.downloadedSubtitleFileCallback=c;a.element.appendChild(a.subtitleSelector.element);a.subtitleView=document.createElement("div");a.subtitleView.classList.add("subtitles_fll_subtitles_tab");a.subtitleView.classList.add("subtitles_fll_scroll_bar");a.subtitleView.style.cssText="position:relative; background-color:#000000; color:#dddddd; width:100%; height:calc(100% - 40px); overflow-y:scroll;";a.element.appendChild(a.subtitleView);
a.subtitlesTabMsgContainer=document.createElement("div");a.subtitlesTabMsgContainer.className="subtitles_fll_subtitles_tab_msg_container";a.subtitlesTabMsgContainer.style.cssText="height: 100%; width: 100%; position: absolute; top: 0; left: 0; pointer-events: none;";a.subtitlesTabMsgContainer.innerHTML='<div style="height: 100px;position: absolute;margin: auto;top: 0;left: 0;bottom: 0;right: 0;font-size: 16px;padding: 20px;">'+b("Please enter the ENGLISH TITLE on Search Tab and search.")+"</div>";
a.subtitleView.insertAdjacentElement("beforeend",a.subtitlesTabMsgContainer);a.encodingMenuElem=document.createElement("div");a.encodingMenuElem.style.cssText="width:100%; text-align:right; margin:5px 0px; background-color:#222;";var r='<select class="subtitles_fll_text_encoding_select" style="margin:10px 10px 10px 5px; width:130px; height:26px; border-radius:13px; padding:0px 10px"><option value="default" disabled selected>'+b("Encoding")+"</option>";subtitlesForLL.languageCode.encodingTypes(subtitlesForLL.configs.learningLanguage).forEach(function(B,
E){r+='<option value="'+B+'">'+B+"</option>"});r+="</select>";a.encodingMenuElem.innerHTML=r;var z=a.encodingMenuElem.getElementsByClassName("subtitles_fll_text_encoding_select").item(0);z.onchange=function(B){if("default"!=z.value){B=z.value;var E=(new TextEncoder).encode(a.originalSubtitleStr);B=(new TextDecoder(B)).decode(E);d(B,a.originalSubtitleType)}};a.subtitleView.appendChild(a.encodingMenuElem);a.subtitlesContainer=document.createElement("div");a.subtitlesContainer.className="subtitles_fll_subtitles_container";
a.subtitlesContainer.style.cssText="width:100%; height:100%; font-size:"+(subtitlesForLL.configs.subtitleScrollViewFontSize||0)+"px;";subtitlesForLL.isRightToLeftLanguage(subtitlesForLL.configs.learningLanguage)?(a.subtitlesContainer.style.direction="rtl",a.subtitlesContainer.style.textAlign="right"):(a.subtitlesContainer.style.direction="ltr",a.subtitlesContainer.style.textAlign="left");a.subtitleView.appendChild(a.subtitlesContainer);a.subtitlesContainer.addEventListener("mouseup",function(B){a.mouseUpCallback&&
a.mouseUpCallback(B)});a.selectMenu(1);window.addEventListener("beforeunload",function(B){a.stopCountSubtitleUsageTime();a.saveUsageSubtitleInfoFile();a.sendUsageSubtitleInfo()});a.subtitleSelector.showLoadingView("Waiting for video to load start...")};var q=function(){var l=subtitlesForLL,h=null,r=null,z=null;if(l.playbackResources&&l.currentContentId&&l.playbackResources[l.currentContentId]&&(l=l.playbackResources[l.currentContentId])){null!=l.seasonNumber&&(r=l.seasonNumber);null!=l.episodeNumber&&
(z=l.episodeNumber);var B=location.hostname,E=null!=document.getElementsByTagName("html").item(0).lang.match(/^en(?:-.+)?$/m);("www.primevideo.com"==B&&E||"www.amazon.com"==B&&E||"www.amazon.co.uk"==B)&&null!=l.title&&(h=l.title)}a.subtitleSelector.setSeasonAndEpisode(h,r,z)};this.videoLoadStart=function(l){a.closeSubtitles();a.subtitleSelector.initAllView();a.subtitleSelector.showLoadingView(b("Waiting for video to be loaded..."))};this.videoLoadedData=function(){q();null==subtitlesForLL.currentCatalogId?
(a.subtitleSelector.showLoadingView(b("Waiting for PlaybackResource to be received...")),setTimeout(function(){a.videoLoadedData()},500)):(a.currentCatalogId=subtitlesForLL.currentCatalogId,a.subtitleSelector.hideLoadingView(),a.subtitleSelector.showSearchInterface(),a.amazonUIChanger&&(a.amazonUIChanger.defaultTiming=0,a.amazonUIChanger.changeSubtitleTiming(0,!1),a.amazonUIChanger.changeBrightness(a.amazonUIChanger.brightness),a.amazonUIChanger.changeContrast(a.amazonUIChanger.contrast),a.amazonUIChanger.changeSaturate(a.amazonUIChanger.saturate)),
e(a.currentCatalogId,function(l){l&&null!=l.text?(a.readUsageSubtitleInfoFile(a.currentCatalogId,function(h){if(null==h||0>=Object.keys(h).length)console.warn("usageSubtitleInfo\u30d5\u30a1\u30a4\u30eb\u304c\u8aad\u307f\u8fbc\u3081\u306a\u304b\u3063\u305f\u304b\u7a7a\u3067\u3059\u3002"),h=g(a.currentCatalogId);a.usageSubtitleInfo=h;h.recommend&&null!=h.recommend.timing&&!1!==subtitlesForLL.configs.enableAutoSubtitleTimingAdjustment&&(a.amazonUIChanger.defaultTiming=Number(h.recommend.timing));null!=
h.timing?a.amazonUIChanger.changeSubtitleTiming(h.timing):h.recommend&&null!=h.recommend.timing&&!1!==subtitlesForLL.configs.enableAutoSubtitleTimingAdjustment&&a.amazonUIChanger.changeSubtitleTiming(h.recommend.timing);0==a.videoElem.paused&&a.startCountSubtitleUsageTime()}),a.originalSubtitleStr=l.text,a.originalSubtitleType=l.type,d(l.text,l.type),a.encodingMenuElem.style.display="block"):(a.encodingMenuElem.style.display="none",f(function(h){h&&(a.usageSubtitleInfo=g(a.currentCatalogId))}))}))};
var f=function(l){var h=subtitlesForLL;if(h.playbackResources&&h.currentContentId&&h.playbackResources[h.currentContentId]&&h.playbackResources[h.currentContentId].subtitleUrls){var r=subtitlesForLL.languageCode.toAmazonLangCode(h.configs.learningLanguage,h.playbackResources[h.currentContentId].subtitleUrls);if(r){m(h.playbackResources[h.currentContentId].subtitleUrls,r,function(z){l&&l(z)});return}}l(!1)};this.startCountSubtitleUsageTime=function(){a.usageSubtitleInfo&&(null!=k&&console.warn("subtitleBeginTime\u304cnull\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002(\u60f3\u5b9a\u5916)"),
k=Math.floor((new Date).getTime()/1E3))};this.stopCountSubtitleUsageTime=function(){null!=k&&a.usageSubtitleInfo&&(a.usageSubtitleInfo.usageTime+=Math.floor((new Date).getTime()/1E3)-k,a.usageSubtitleInfo.usageRate=0==a.usageSubtitleInfo.usageTime?0:a.usageSubtitleInfo.usageTime/a.usageSubtitleInfo.videoDuration*100,k=null)};var g=function(l){var h={};h.userIdentifier=subtitlesForLL.configs.userIdentifier;h.catalogId=l;h.usageTime=0;h.usageRate=0;h.videoDuration=a.videoElem.duration-a.adDuration;
h.timing=0;return h},c=function(l,h,r,z){if(null!=r&&0<r.length){a.usageSubtitleInfo&&(a.saveUsageSubtitleInfoFile(),a.sendUsageSubtitleInfo());a.removeSubtitleSettingFile(l);a.amazonUIChanger&&(a.amazonUIChanger.defaultTiming=0,a.amazonUIChanger.changeSubtitleTiming(0,!1));var B="srt";"localSubtitle"==z?B=h.SubFormat:h&&h.SubFormat&&0<h.SubFormat.length&&(B=h.SubFormat);a.originalSubtitleStr=r;a.originalSubtitleType=B;d(r,B);a.encodingMenuElem.style.display="block";a.usageSubtitleInfo="localSubtitle"!=
z?g(l):null;"search"==z?a.usageSubtitleInfo.openSubtitlesOrg=h:"recommend"==z&&(a.usageSubtitleInfo.recommend=h,null!=h.timing&&!1!==subtitlesForLL.configs.enableAutoSubtitleTimingAdjustment&&(a.amazonUIChanger.defaultTiming=Number(h.timing),a.amazonUIChanger.changeSubtitleTiming(Number(h.timing))));0==a.videoElem.paused&&a.startCountSubtitleUsageTime();a.saveUsageSubtitleInfoFile()}else a.encodingMenuElem.style.display="none"};this.readUsageSubtitleInfoFile=function(l,h){l="/"+encodeURIComponent(l)+
"_"+subtitlesForLL.configs.learningLanguage+".json";var r=chrome.extension.connect({name:"Subtitles for Language Learning (Prime Video)"});r.onMessage.addListener(function(z){r.disconnect();r=null;null==z?h({}):(z=JSON.parse(z.text),h&&h(z))});r.postMessage({type:"readFile",filePath:l})};this.saveUsageSubtitleInfoFile=function(){if(!(null==a.usageSubtitleInfo||0>=Object.keys(a.usageSubtitleInfo).length)){a.stopCountSubtitleUsageTime();var l="/"+encodeURIComponent(a.currentCatalogId)+"_"+subtitlesForLL.configs.learningLanguage+
".json",h=chrome.extension.connect({name:"Subtitles for Language Learning (Prime Video)"});h.onMessage.addListener(function(){h.disconnect();h=null});h.postMessage({type:"saveFile",filePath:l,text:JSON.stringify(a.usageSubtitleInfo)})}};this.removeSubtitleSettingFile=function(l){l="/"+encodeURIComponent(l)+"_"+subtitlesForLL.configs.learningLanguage+".json";var h=chrome.extension.connect({name:"Subtitles for Language Learning (Prime Video)"});h.onMessage.addListener(function(){h.disconnect();h=null});
h.postMessage({type:"removeFile",filePath:l})};this.sendUsageSubtitleInfo=function(){null==a.usageSubtitleInfo||0>=Object.keys(a.usageSubtitleInfo).length||0==a.usageSubtitleInfo.usageTime||(a.stopCountSubtitleUsageTime(),a.usageSubtitleInfo=null)};var e=function(l,h){l="/"+encodeURIComponent(l)+"_"+subtitlesForLL.configs.learningLanguage;var r=chrome.extension.connect({name:"Subtitles for Language Learning (Prime Video)"});r.onMessage.addListener(function(z){r.disconnect();r=null;null==z?h&&h(null):
h&&h(z)});r.postMessage({type:"readSubtitleFile",filePath:l})};this.loadSubtitleArray=function(l){x(l)};var d=function(l,h){var r=new SubtitlesForLLSubtitleFile,z;"srt"==h.toLowerCase()||"vtt"==h.toLowerCase()?z=r.parseSubtitles(l):"ssa"==h.toLowerCase()?z=r.parseSubtitlesOfSsa(l):console.warn("loadSubtitlesString() - \u5bfe\u5fdc\u5916\u306etype\u306e\u5b57\u5e55\u3067\u3059\u3002type == "+h);x(z)},m=function(l,h,r){(new SubtitlesForLLSubtitleFile).loadAmazonSubtitleUrls(l,h,function(z,B){z?r&&r(!1):
B?(a.loadSubtitleArray(B),r&&r(!0)):r&&r(!1)})};this.closeSubtitles=function(){a.subtitles=null;a.currentSubtitleIndex=-1;a.activeSubtitleElems=[];a.readPositionSubtitleElem=null;n&&(n.disconnect(),n=null);u=0;a.subtitlesTabMsgContainer.style.display="block";a.subtitlesContainer.innerHTML="";a.overlaySubtitleElem.innerHTML="";a.subtitleView.scroll(0,0);a.selectMenu(1)};var w=function(l){for(var h=a.element.getElementsByClassName("subtitles_fll_menu_button"),r=0;r<h.length;r++)h[r]==l.target&&a.selectMenu(r)};
this.selectMenu=function(l){for(var h=a.element.getElementsByClassName("subtitles_fll_menu_button"),r=0;r<h.length;r++)r==l?(h[r].style.backgroundColor="rgb(34, 34, 34)",h[r].style.color=null):(h[r].style.backgroundColor="#000",h[r].style.color="#999");a.settingsView&&(a.settingsView.close(),a.settingsView=null);a.userWordsView&&(a.userWordsView.close(),a.userWordsView=null);0==l?(a.subtitleView.style.display="block",a.subtitleSelector.element.style.display="none"):1==l?(a.subtitleView.style.display=
"none",a.subtitleSelector.element.style.display="block"):2==l?(a.subtitleView.style.display="none",a.settingsView=new SubtitlesForLLSettingsView,a.settingsView.init(),a.element.appendChild(a.settingsView.element),a.subtitleSelector.element.style.display="none"):3==l&&(a.subtitleView.style.display="none",a.subtitleSelector.element.style.display="none",a.userWordsView=new SubtitlesForLLUserWordsView,a.userWordsView.init(),a.element.appendChild(a.userWordsView.element),a.userWordsView.callback=function(){a.recreateSubtitleCells()})};
this.recolorSubtitleCells=function(l,h){null!=h.regex&&null!=h.color&&(u=0,a.subtitles.forEach(function(r,z){null!=r.text.match(new RegExp(h.regex,"i"))&&(r=a.subtitlesContainer.childNodes[z],null!=r&&(r=r.querySelector(".subtitles_fll_cell_subtitle_container"),p(a.subtitles,z,r)))}))};this.recolorSubtitleAllCells=function(){u=0;a.subtitles.forEach(function(l,h){for(var r=subtitlesForLL.userWords.keys();userWordKey=r.next().value;){var z=subtitlesForLL.userWords.get(userWordKey);if(null!=l.text.match(new RegExp(z.regex,
"i"))){z=a.subtitlesContainer.childNodes[h];if(null==z)break;z=z.querySelector(".subtitles_fll_cell_subtitle_container");p(a.subtitles,h,z)}}})};this.recreateSubtitleCells=function(){u=0;a.subtitles.forEach(function(l,h){l=a.subtitlesContainer.childNodes[h].querySelector(".subtitles_fll_cell_subtitle_container");p(a.subtitles,h,l)})};var x=function(l){a.closeSubtitles();a.subtitlesTabMsgContainer.style.display="none";a.selectMenu(0);null==a.loadingElem&&(a.loadingElem=document.createElement("div"),
a.loadingElem.className="subtitles_fll_loading_container",a.loadingElem.style.cssText="position:fixed; width:"+subtitlesForLL.SUBTITLE_CONTENTS_VIEW_WIDTH+"px; height:calc(100% - 40px); top:40px; right:0; background-color:rgba(0,0,0,0.5);",1==subtitlesForLL.isRightToLeftLanguage(subtitlesForLL.configs.learningLang)&&(a.loadingElem.style.left="0",a.loadingElem.style.right="auto"),a.loadingElem.innerHTML='<div style="position:absolute; width:100%; height:80px; top:0; left:0; right:0; bottom:0; margin:auto;"><div style="text-align:center;">'+
b("Tokenizing...")+'</div><?xml version="1.0" encoding="utf-8"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin:auto; background:none; display:block; shape-rendering:auto;" width="80px" height="80px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="#dddddd" stroke-width="7" r="32" stroke-dasharray="150.79644737231007 52.26548245743669"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></svg></div>',
a.subtitleView.insertAdjacentElement("beforeend",a.loadingElem));a.subtitles=l;l=subtitlesForLL.languageCode.toDeepLCode(subtitlesForLL.configs.nativeLanguage)&&subtitlesForLL.languageCode.toDeepLCode(subtitlesForLL.configs.learningLanguage);for(var h={$jscomp$loop$prop$i$58:0};h.$jscomp$loop$prop$i$58<a.subtitles.length;h={$jscomp$loop$prop$cell$53:h.$jscomp$loop$prop$cell$53,$jscomp$loop$prop$i$58:h.$jscomp$loop$prop$i$58,$jscomp$loop$prop$subtitleContainerElem$59:h.$jscomp$loop$prop$subtitleContainerElem$59},
h.$jscomp$loop$prop$i$58++){h.$jscomp$loop$prop$cell$53=document.createElement("div");h.$jscomp$loop$prop$cell$53.className="subtitles_fll_cell";h.$jscomp$loop$prop$cell$53.dataset.index=h.$jscomp$loop$prop$i$58;var r=document.createElement("div");r.className="subtitles_fll_cell_seek";var z=chrome.extension.getURL("icons/play_button64.png");r.innerHTML='<img src="'+z+'" alt="">';r.onclick=function(E){return function(G){if(a.clickSeekButtonCallback)for(var H=0;H<a.subtitlesContainer.childNodes.length;H++)if(a.subtitlesContainer.childNodes[H]==
E.$jscomp$loop$prop$cell$53){a.clickSeekButtonCallback(G,a.subtitles[H]);break}}}(h);h.$jscomp$loop$prop$cell$53.insertAdjacentElement("beforeend",r);h.$jscomp$loop$prop$subtitleContainerElem$59=p(a.subtitles,h.$jscomp$loop$prop$i$58);h.$jscomp$loop$prop$subtitleContainerElem$59.dataset.index=h.$jscomp$loop$prop$i$58;h.$jscomp$loop$prop$cell$53.insertAdjacentElement("beforeend",h.$jscomp$loop$prop$subtitleContainerElem$59);r=document.createElement("div");r.className="subtitles_fll_cell_google_translate";
r.title=b("Google Translate");z=chrome.extension.getURL("icons/google_translate60.png");var B=document.createElement("img");B.src=z;B.setAttribute("alt","");r.appendChild(B);h.$jscomp$loop$prop$cell$53.insertAdjacentElement("beforeend",r);r.addEventListener("mouseenter",function(E){return function(G){if(a.mouseEnterCallback)return a.mouseEnterCallback("googleDict",G,{index:E.$jscomp$loop$prop$i$58,subtitleContainerElem:E.$jscomp$loop$prop$subtitleContainerElem$59})}}(h),!1);r.addEventListener("mouseleave",
function(E){return function(G){if(a.mouseLeaveCallback)return a.mouseLeaveCallback("googleDict",G,{index:E.$jscomp$loop$prop$i$58,subtitleContainerElem:E.$jscomp$loop$prop$subtitleContainerElem$59})}}(h),!1);r.addEventListener("click",function(E){return function(G){if(a.clickCallback)return a.clickCallback("googleDict",G,{index:E.$jscomp$loop$prop$i$58,subtitleContainerElem:E.$jscomp$loop$prop$subtitleContainerElem$59})}}(h),!1);l&&(r=document.createElement("div"),r.className="subtitles_fll_cell_deepl_translate",
z=chrome.extension.getURL("icons/deepl.svg"),B=document.createElement("img"),B.src=z,B.setAttribute("alt",""),r.onclick=v,r.appendChild(B),h.$jscomp$loop$prop$cell$53.insertAdjacentElement("beforeend",r));a.subtitlesContainer.insertAdjacentElement("beforeend",h.$jscomp$loop$prop$cell$53)}},D=function(){a.loadingElem&&(a.loadingElem.remove(),a.loadingElem=null);null!=n&&(n.disconnect(),n=null)},t=subtitlesForLL.userWordsColor,p=function(l,h,r){if(null==r){r=document.createElement("div");r.className=
"subtitles_fll_cell_subtitle_container";var z=subtitlesForLL.isRightToLeftLanguage(subtitlesForLL.configs.learningLanguage);"rtl"==subtitlesForLL.direction!=z&&(r.style.cssText="direction:"+(z?"rtl;":"ltr;"))}l=l[h].text;z=subtitlesForLL.userWords;for(var B=z.keys();userWordKey=B.next().value;){var E=z.get(userWordKey),G=E.regex;null!=G&&(l=l.replace(new RegExp(G,"ig"),'<font color="'+t[E.color]+'">$1</font>'))}null==n&&(n=chrome.extension.connect({name:"Subtitles for Language Learning (Prime Video)"}));
n.onMessage.addListener(C);n.postMessage({type:"tokenize",index:h,word:l,from:subtitlesForLL.configs.learningLanguage,to:subtitlesForLL.configs.nativeLanguage});return r},C=function(l){u++;var h=l.words;l=a.subtitlesContainer.children[l.index].querySelector(".subtitles_fll_cell_subtitle_container");var r="",z=0;if(null!=h)for(var B=0;B<h.length;B++)null!=h[B].word?(r+='<span data-index="'+z+'">'+h[B].word+"</span>",z+=h[B].word.length):null!=h[B].separate?(r+=h[B].separate,z+=h[B].separate.length):
null!=h[B].tag&&(r+=h[B].tag);l.innerHTML=r;A(l);u>=a.subtitles.length&&D&&D()},A=function(l){if(0==SubtitlesForLLWordPopupWindow.isMouseEnterPopupNotSupportLanguage(subtitlesForLL.configs.learningLanguage)&&(l=l.getElementsByTagName("span")))for(var h=0;h<l.length;h++)l[h].addEventListener("mouseenter",function(r){r.target.style.backgroundColor="#448";if(a.mouseEnterCallback)return a.mouseEnterCallback("word",r)},!1),l[h].addEventListener("mouseleave",function(r){r.target.style.backgroundColor=null;
if(a.mouseLeaveCallback)return a.mouseLeaveCallback("word",r)},!1),l[h].addEventListener("click",function(r){if(a.clickCallback)return a.clickCallback("word",r)},!1)},v=function(l){var h=l.target.parentElement.getElementsByClassName("subtitles_fll_cell_subtitle_container");if(null==h||0>=h.length)console.warn("clickedGoogleTranslate() - \u5b57\u5e55\u304c\u5165\u3063\u3066\u3044\u308b.subtitles_fll_cell_subtitle_container\u3092\u53d6\u5f97\u51fa\u6765\u307e\u305b\u3093\u3067\u3057\u305f\u3002(\u60f3\u5b9a\u5916)");
else{h=encodeURIComponent(h[0].innerText.replace(/\n/g," "));if("subtitles_fll_cell_google_translate"==l.target.className){var r=subtitlesForLL.languageCode.toGoogleLangCode(subtitlesForLL.configs.nativeLanguage)||"auto";var z=subtitlesForLL.languageCode.toGoogleLangCode(subtitlesForLL.configs.learningLanguage)||"auto";h="https://translate.google.com/?hl="+r+"&sl="+z+"&tl="+r+"&text="+h+"&op=translate";r="GoogleTranslate"}else if("subtitles_fll_cell_deepl_translate"==l.target.className)r=subtitlesForLL.languageCode.toDeepLCode(subtitlesForLL.configs.nativeLanguage)||
"auto",h="https://www.deepl.com/translator#"+(subtitlesForLL.languageCode.toDeepLCode(subtitlesForLL.configs.learningLanguage)||"auto")+"/"+r+"/"+h,r="DeepL";else{console.error("clickedTranslate() - \u30bf\u30fc\u30b2\u30c3\u30c8\u306e\u89aa\u30af\u30e9\u30b9\u304c\u60f3\u5b9a\u5916\u3067\u3059");return}window.open(h,r,"top="+(l.screenY-217.5)+", left="+(window.screenX+window.outerWidth)+", width=760, height=435")}};this.scrollToSec=function(l){a.currentSubtitleIndex=-1;a.syncSubtitle(l)};this.syncSubtitle=
function(l){if(!(null==a.subtitles||0>=a.subtitles.length||0>=a.subtitlesContainer.childNodes.length)){for(var h=0;h<a.activeSubtitleElems.length;h++){var r=a.subtitles[a.activeSubtitleElems[h].dataset.index];if(r.startTime>l||r.endTime<=l){r=a.subtitles.indexOf(r);a.subtitlesContainer.childNodes[r].style.backgroundColor="#222";a.activeSubtitleElems.splice(h,1);h--;for(var z=0;z<a.overlaySubtitleElem.childNodes.length;z++)if(a.overlaySubtitleElem.childNodes[z].dataset.index==r){a.overlaySubtitleElem.childNodes[z].remove();
break}}}for(h=a.currentSubtitleIndex+1;h<a.subtitles.length;h++)if(r=a.subtitles[h],z=a.subtitlesContainer.childNodes[h],r.startTime<=l){if(a.currentSubtitleIndex=h,r.endTime>l&&!(0<=a.activeSubtitleElems.indexOf(z))&&(a.activeSubtitleElems.push(z),z.style.backgroundColor="#666",r=z.querySelector(".subtitles_fll_cell_subtitle_container").cloneNode(!0)))A(r),r.className="subtitles_fll_overlay_subtitle_cell_container",r.dataset.index=h,a.overlaySubtitleElem.appendChild(r)}else break;l=null!=a.currentSubtitleIndex?
a.currentSubtitleIndex+1:0;var B;l<a.subtitlesContainer.childNodes.length&&(B=a.subtitlesContainer.childNodes[l]);B!=a.readPositionSubtitleElem&&null!=a.readPositionSubtitleElem&&0>a.activeSubtitleElems.indexOf(a.readPositionSubtitleElem)&&(a.readPositionSubtitleElem.style.backgroundColor="#222");0>=a.activeSubtitleElems.length&&null!=B&&(B.style.backgroundColor="#444");a.readPositionSubtitleElem=B;0<=a.currentSubtitleIndex&&a.currentSubtitleIndex<a.subtitles.length&&(B=a.subtitlesContainer.childNodes[a.currentSubtitleIndex].getBoundingClientRect(),
(B.bottom>a.subtitlesContainer.clientHeight||0>B.top)&&a.subtitlesContainer.childNodes[0<a.currentSubtitleIndex?a.currentSubtitleIndex-1:0].scrollIntoView(!0))}}};function SubtitlesForLLSubtitleFile(){var a=this;this.loadAmazonSubtitleUrls=function(b,k,n){for(var u,q=0;q<b.length;q++)if(b[q].languageCode&&b[q].languageCode==k){u=b[q].url;break}if(null==u)n("NOT_FOUND_IN_AMAZON",null);else{var f=new XMLHttpRequest;f.open("GET",u,!0);f.onloadend=function(g){if(200==f.status){a:{g=f.responseText;try{var c=(new DOMParser).parseFromString(g,"text/xml")}catch(m){console.error("parseAmazonStyle() - Amazon\u306e\u5b57\u5e55\u30d5\u30a1\u30a4\u30eb\u306eDOMParser\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002");
console.error(m);c=null;break a}c=c.querySelectorAll("body p");g="";for(var e=0;e<c.length;e++){var d=c[e].innerHTML.trim();""!=d&&(0==k.indexOf("ar")&&(d=d.replace(/^(?!\u202B|\u200F)/gm,"\u202b")),d=d.replace(/<br [^>]*>/g,"\n"),g+=e+"\n",g+=c[e].getAttribute("begin").replace(".",",")+" --\x3e "+c[e].getAttribute("end").replace(".",",")+"\n",g+=d+"\n\n")}c=g}c=a.parseSubtitles(c);n&&n(null,c)}else n&&n("ERROR:"+f.status,null)};f.send()}};this.parseSubtitles=function(b){b=b.replace(/\r\n|\r/g,"\n");
b=b.replace(/^NOTE(?:\n\n|[ \n][\s\S]*?(?:\n\n|z))/gm,"\n");b=b.split("\n\n");for(var k=[],n=0;n<b.length;n++){var u=b[n].match(/(?:([0-9]*):)?([0-9]{1,2}):([0-9]{1,2})(?:.([0-9]+))?(?: ?--\x3e ?)(?:([0-9]*):)?([0-9]{1,2}):([0-9]{1,2})(?:.([0-9]+))?[^\n]*\n([^$]*)/);null!=u&&k.push({startTime:3600*Number(u[1]||0)+60*Number(u[2]||0)+Number(u[3]||0)+Number("0."+(u[4]||0)),endTime:3600*Number(u[5]||0)+60*Number(u[6]||0)+Number(u[7]||0)+Number("0."+(u[8]||0)),text:u[9]})}k.sort(function(q,f){return q.startTime<
f.startTime?-1:q.startTime>f.startTime?1:0});return k};this.parseSubtitlesOfSsa=function(b){b=b.replace(/\r\n|\r/g,"\n");var k=[],n=b.match(/(?:\n|A)\[Events\]\n([\s\S]*)/);if(null==n||0>=n.length)return k;b=n[1];n=b.match(/^Format:[ ]*(.*)$/m);if(null==n||2>n.length)return k;n=n[1].split(/,[ ]*/g);var u=n.indexOf("Text");0>u&&(u=n.length);var q=n.indexOf("Start");var f=n.indexOf("End");if(0>q||0>f)return k;n="^Dialogue:[ ]*";for(var g=0;g<u;g++)n+="([^,\\n]*),";n+="(.*)";b=b.split("\n");if(null==
b||0>=b.length)return k;var c=new RegExp(n,"m");b.forEach(function(e){var d=e.match(c);if(!(null==d||d.length<=u+1)){var m=d[f+1];e=d[u+1];null==e||0>=e.length||(d=d[q+1].match(/(?:([0-9]*):)?([0-9]{1,2}):([0-9]{1,2})(?:.([0-9]+))?/),m=m.match(/(?:([0-9]*):)?([0-9]{1,2}):([0-9]{1,2})(?:.([0-9]+))?/),e=e.replace(/\{.*?\}/g,"").replace(/\\n/gi," "),k.push({startTime:3600*Number(d[1]||0)+60*Number(d[2]||0)+Number(d[3]||0)+Number("0."+(d[4]||0)),endTime:3600*Number(m[1]||0)+60*Number(m[2]||0)+Number(m[3]||
0)+Number("0."+(m[4]||0)),text:e}))}});k.sort(function(e,d){return e.startTime<d.startTime?-1:e.startTime>d.startTime?1:0});return k}};function SubtitlesForLLPlayerController(){var a=this,b=null;this.isClosed=!0;this.isReceivedNewCatalogId=this.isLoadedData=!1;var k=null,n=null,u=null,q=null,f=null,g=this.videoElem=null,c=0;this.closeCallback=null;this.init=function(t,p,C,A){function v(){return setTimeout(function(){G=null;l.classList.remove("subtitles_fll_show_animation");l.classList.add("subtitles_fll_hide_animation")},1500)}a.isClosed=!1;u=t;a.videoElem=C;g=A;q=p;b=new SubtitlesForLLAmazonUIChanger(a.videoElem);b.clickedButtonCallback=
function(y){"play"==y?a.play():"pause"==y?a.pause():"fastSeekForward"==y?a.seekToSec(a.videoElem.currentTime+10):"fastSeekBack"==y&&a.seekToSec(a.videoElem.currentTime-10)};b.change();b.subtitleTimingDifferenceCallback=D;f=b.subtitlesMainContainer;(p.getElementsByClassName("atvwebplayersdk-playerclose-button").item(0)||p.getElementsByClassName("closeButtonWrapper").item(0)).onclick=e;k=new SubtitlesForLLContentsView;k.amazonUIChanger=b;k.init(a.videoElem);k.overlaySubtitleElem=b.overlaySubtitleContainerElem;
f.appendChild(k.element);x();t=document.createElement("style");t.innerText="#subtitles_fll_player_box{width:100%; height:100%; position:fixed; top:0px; left:0px; z-index:200;}";document.getElementsByTagName("head")[0].appendChild(t);n=new SubtitlesForLLWordPopupWindow;n.init();n.clickCallback=function(y,F){var I=F.key;F=F.dic;"addUserWord"!=y&&"deleteUserWord"!=y||k.recolorSubtitleCells(I,F)};f.appendChild(n.element);var l=document.createElement("div");l.className="subtitles_fll_open_close_button_container";
l.style.cssText="direction:ltr; background-color:rgba(100,100,100,0.5); position:absolute; width:20px; height:40px; top:80px; right:"+subtitlesForLL.SUBTITLE_CONTENTS_VIEW_WIDTH+"px; bottom:auto; left:auto; z-index:10001; cursor:pointer;";t=chrome.extension.getURL("icons/double-right.svg");p=chrome.extension.getURL("icons/double-left.svg");var h=document.createElement("img");h.alt="close";h.style.cssText="width:20px; height:40px;";if(0==subtitlesForLL.isRightToLeftLanguage(subtitlesForLL.configs.learningLanguage)){l.style.right=
""+subtitlesForLL.SUBTITLE_CONTENTS_VIEW_WIDTH+"px";l.style.borderRadius="20px 0px 0px 20px";h.style.marginLeft="3px";var r=t;var z=p}else l.style.left=""+subtitlesForLL.SUBTITLE_CONTENTS_VIEW_WIDTH+"px",l.style.borderRadius="0px 20px 20px 0px",h.style.marginRight="3px",r=p,z=t;h.src=r;l.insertAdjacentElement("beforeend",h);var B=q.getElementsByClassName("scalingVideoContainer").item(0),E=q.getElementsByClassName("webPlayerUIContainer").item(0)||q.getElementsByClassName("scalingUiContainer").item(0);
l.onclick=function(y){l.style.transition="unset";y=document.getElementById("subtitles_fll_overlay_container");"none"==k.element.style.display?(k.element.style.display="block",h.src=r,h.alt="close",0==subtitlesForLL.isRightToLeftLanguage(subtitlesForLL.configs.learningLanguage)?l.style.right=subtitlesForLL.SUBTITLE_CONTENTS_VIEW_WIDTH+"px":l.style.left=subtitlesForLL.SUBTITLE_CONTENTS_VIEW_WIDTH+"px",B&&(B.style.width="calc(100% - "+subtitlesForLL.SUBTITLE_CONTENTS_VIEW_WIDTH+"px)"),E&&(E.style.width=
"calc(100% - "+subtitlesForLL.SUBTITLE_CONTENTS_VIEW_WIDTH+"px)"),y&&(y.style.width="calc(100% - "+subtitlesForLL.SUBTITLE_CONTENTS_VIEW_WIDTH+"px)")):(k.element.style.display="none",h.src=z,h.alt="open",0==subtitlesForLL.isRightToLeftLanguage(subtitlesForLL.configs.learningLanguage)?l.style.right="0px":l.style.left="0px",B&&(B.style.width="100%"),E&&(E.style.width="100%"),y&&(y.style.width="100%"))};f.insertAdjacentElement("beforeend",l);var G=v();E.addEventListener("mousemove",function(y){G&&(clearTimeout(G),
G=null);l.classList.remove("subtitles_fll_hide_animation");l.classList.add("subtitles_fll_show_animation");G=v()});k.clickCallback=function(y,F,I){"word"==y?(y=window.getSelection().toString(),y&&0<y.length||(y=F.target.innerText,null==y||0>y.length||(n.draw(F.target.innerText,{clipMode:!0,eventTarget:F.target}),H=!1))):"googleDict"==y&&n.draw(I.subtitleContainerElem.innerText,{clipMode:!0,eventTarget:F.target})};k.mouseLeaveCallback=function(y,F){"word"!=y&&"googleDict"!=y||0!=n.isClipMode||(n.hide(!1),
"subtitles_fll_overlay_subtitle_cell_container"==F.target.parentElement.className&&(1==a.videoElem.paused&&H&&a.play(),H=!1))};var H=!1;k.mouseEnterCallback=function(y,F,I){if("word"==y||"googleDict"==y)if(1==n.isHidden||0==n.isClipMode)y="word"==y?F.target.innerText:I.subtitleContainerElem.innerText,y=y.replace(/\n/g," "),n.draw(y,{eventTarget:F.target}),"subtitles_fll_overlay_subtitle_cell_container"==F.target.parentElement.className&&0==a.videoElem.paused&&(a.pause(),H=!0)};k.mouseUpCallback=function(y){var F=
window.getSelection().toString();F&&0<F.length&&(enableClick=!1,n.draw(F,{forceDraw:!0,clipMode:!0,isSelectedText:!0,eventTarget:y.target}))};k.clickSeekButtonCallback=function(y,F){a.seekToSubtitle(F,y)};u.addEventListener("click",function(y){var F=window.getSelection().toString();F&&0<F.length||(0==n.isHidden()&&0==n.element.contains(y.target)&&y.target!=n.element&&n.hide(!0),0==b.adjustmentMenuIsHide()&&0==b.adjustmentMenuElem.contains(y.target)&&y.target!=b.adjustmentMenuElem&&b.hideAdjustmentMenu())},
!0);document.onkeydown=function(y){if("Space"==y.code&&y.target==document.body)return a.videoElem.paused?a.play():a.pause(),!1};if(t=document.querySelector(".cascadesContainer"))t.addEventListener("keydown",function(y){"INPUT"==y.target.tagName&&y.stopPropagation()},!0),t.addEventListener("keyup",function(y){"INPUT"==y.target.tagName&&y.stopPropagation()},!0);document.addEventListener("keyup",function(y){if("INPUT"==y.target.tagName)return!0;if("KeyF"==y.code||y.shiftKey&&"Period"==y.code){var F=
2>a.videoElem.playbackRate+.1?a.videoElem.playbackRate+.1:2;b.changePlaybackRate(F.toFixed(1));a.showOverlayMessage("x"+F.toFixed(1));y.stopImmediatePropagation()}else"KeyS"==y.code||y.shiftKey&&"Comma"==y.code?(y=.1<a.videoElem.playbackRate-.1?a.videoElem.playbackRate-.1:.1,b.changePlaybackRate(y.toFixed(1)),a.showOverlayMessage("x"+y.toFixed(1))):"KeyE"==y.code||y.shiftKey&&"ArrowLeft"==y.code?(y=k.currentSubtitleIndex,F=k.subtitles,0<=y&&y<F.length&&(.5>a.videoElem.currentTime-c-F[y].startTime+
b.timing&&0<y?a.seekToSubtitle(F[y-1]):a.seekToSubtitle(F[y]))):"KeyD"==y.code||y.shiftKey&&"ArrowRight"==y.code?(y=k.currentSubtitleIndex,F=k.subtitles,0<=y&&y+1<F.length&&a.seekToSubtitle(F[y+1])):"KeyR"==y.code&&a.seekToSec(a.videoElem.currentTime-subtitlesForLL.configs.quickBackSec);return!1},!0);u.addEventListener("mouseenter",function(y){});window.addEventListener("resize",function(y){n.refreshPosition(n.targetX,n.targetY)},!1);return a};var e=function(t){a.close();document.getElementById("subtitles_fll_main_container").remove()};
this.close=function(){a.isClosed||(k.closeSubtitles(),k.saveUsageSubtitleInfoFile(),k.sendUsageSubtitleInfo(),a.isLoadedData=!1,a.isClosed=!0,a.closeCallback())};this.play=function(){if(0==subtitlesForLL.isChromeOSMode)a.videoElem.paused&&a.videoElem.play();else if(a.videoElem.paused){var t=q.querySelector(".pausedOverlay");t&&(t.dispatchEvent(new PointerEvent("pointerdown",{pointerType:"mouse"})),t.dispatchEvent(new PointerEvent("pointerup",{pointerType:"mouse"})))}};this.pause=function(){if(0==
subtitlesForLL.isChromeOSMode)0==a.videoElem.paused&&a.videoElem.pause();else if(0==a.videoElem.paused){var t=q.querySelector(".pausedOverlay");t&&(t.dispatchEvent(new PointerEvent("pointerdown",{pointerType:"mouse"})),t.dispatchEvent(new PointerEvent("pointerup",{pointerType:"mouse"})))}};var d=!1;this.seekToSubtitle=function(t){t=t.startTime-.1+c-b.timing;a.seekToSec(0>t?0:t)};this.seekToSec=function(t){if(0==subtitlesForLL.isChromeOSMode)a.videoElem.paused&&a.play(),a.videoElem.currentTime=t;else{var p=
g.parentElement,C=p.getElementsByClassName("progressBar").item(0),A=C.getBoundingClientRect();t=A.left+(t-c)/a.videoElem.duration*C.offsetWidth;C=new PointerEvent("pointerdown",{pointerType:"mouse",clientX:t,clientY:A.top});p.dispatchEvent(C);A=new PointerEvent("pointerup",{pointerType:"mouse",clientX:t,clientY:A.top});p.dispatchEvent(A);a.videoElem.paused&&(d=!0)}};var m;this.showOverlayMessage=function(t){m&&(clearTimeout(m),m=null);var p=f.getElementsByClassName("subtitles_fll_overlay_message").item(0);
null==p&&(p=document.createElement("div"),p.className="subtitles_fll_overlay_message",p.style.cssText="position:absolute; text-align:left; font-size:40px; color:#ddd; z-index:10000; margin:50px; top:0px; left:0px;");p.innerHTML=t;f.insertAdjacentElement("beforeend",p);m=setTimeout(function(){p.remove();m=null},1E3)};this.changeVideoElem=function(t){a.videoElem=t;subtitlesForLL.isChromeOSMode&&(g.style.width="0.0%");k.changeVideoElem(a.videoElem);b.changeVideoElem(a.videoElem);x()};this.setReceivedNewCatalogId=
function(t){(a.isReceivedNewCatalogId=t)&&0==a.isLoadedData&&w()};var w=function(){0==a.isReceivedNewCatalogId||a.isLoadedData||null==a.videoElem||2>a.videoElem.readyState||(a.isClosed=!1,a.isReceivedNewCatalogId=!1,a.isLoadedData=!0,a.refreshAdDuration(),k.videoLoadedData(null),subtitlesForLL.configs.playbackRate&&a.videoElem.playbackRate!=subtitlesForLL.configs.playbackRate&&(a.videoElem.playbackRate=subtitlesForLL.configs.playbackRate),b.refreshSubtitlePosition(),b.refreshAmazonSubtitlePosition())},
x=function(){k.videoLoadStart(void 0);a.videoElem.addEventListener("loadedmetadata",function(p){},!1);var t=function(p){a.isLoadedData||0==a.isReceivedNewCatalogId||w()};a.videoElem.addEventListener("loadeddata",t,!0);2<=a.videoElem.readyState&&t();a.videoElem.addEventListener("timeupdate",function(p){a.videoElem&&(180>=a.videoElem.currentTime&&a.refreshAdDuration(),p=0,null!=b.timing&&(p=b.timing),k.syncSubtitle(a.videoElem.currentTime-c+p))},!1);a.videoElem.addEventListener("seeking",function(p){isNaN(a.videoElem.duration)&&
console.warn("seeking\u30a4\u30d9\u30f3\u30c8\u3092\u53d7\u4fe1\u3057\u307e\u3057\u305f\u304cvideo.duration\u304cNaN\u3067\u3059\u3002\u60f3\u5b9a\u5916\u3067\u3059\u3002seeking\u3067\u306f\u306a\u304fseeked\u3067adDuration\u306e\u8a08\u7b97\u3092\u3059\u3079\u304d\u304b\u3082");p=0;null!=b.timing&&(p=b.timing);k.scrollToSec(a.videoElem.currentTime-c+p)},!1);a.videoElem.addEventListener("seeked",function(p){a.refreshAdDuration()},!1);a.videoElem.addEventListener("play",function(p){0==a.isLoadedData&&
w();k.startCountSubtitleUsageTime()},!1);a.videoElem.addEventListener("pause",function(p){k.stopCountSubtitleUsageTime()},!1);a.videoElem.addEventListener("waiting",function(p){},!1);a.videoElem.addEventListener("playing",function(p){},!1);a.videoElem.addEventListener("suspend",function(p){},!1);a.videoElem.addEventListener("progress",function(p){},!1);a.videoElem.addEventListener("canplay",function(p){0==a.isLoadedData&&w()},!1);a.videoElem.addEventListener("canplaythrough",function(p){0==a.isLoadedData&&
w();d&&(d=!1,a.videoElem.paused&&a.play())},!1);a.videoElem.addEventListener("stalled",function(p){},!1);a.videoElem.addEventListener("ended",function(p){k.saveUsageSubtitleInfoFile();k.sendUsageSubtitleInfo()},!1);a.videoElem.addEventListener("abort",function(p){k.saveUsageSubtitleInfoFile();k.sendUsageSubtitleInfo()},!1);a.videoElem.addEventListener("error",function(p){},!1)},D=function(t){k.usageSubtitleInfo&&(k.usageSubtitleInfo.timing=t,k.saveUsageSubtitleInfoFile());k.scrollToSec(a.videoElem.currentTime-
c+t)};this.refreshAdDuration=function(){if(null==a.videoElem||isNaN(a.videoElem.duration)||null==g)c=0;else{var t=SubtitlesForLLPlayerController.calcAdDuration(a.videoElem,g);c!=t&&(c=t)}k.adDuration=c};this.getCurrentTime=function(){return a.videoElem.currentTime()-c}}
SubtitlesForLLPlayerController.calcAdDuration=function(a,b){if("INPUT"==b.tagName)var k=b.value;else"SPAN"==b.tagName?(k=parseFloat(b.style.width),isNaN(k)&&(k=0)):console.error("seekBarElem\u306etagName\u304c\u4f8b\u5916\u3067\u3059\u3002");a=0==subtitlesForLL.isChromeOSMode?(a.duration*k-100*a.currentTime)/(k-100):-(a.duration*k-100*a.currentTime)/100;return.02>a?0:a};function SubtitlesForLLSubtitleSelector(){var a=this,b=subtitlesForLL.localize.localize;this.searchResults=this.currentSeasonNumber=this.currentEpisodeNumber=null;this.element=document.createElement("div");this.element.style.cssText="height:calc(100% - 40px);  overflow-y:scroll; color:#ddd;";this.downloadedSubtitleFileCallback=this.localSubtitle=this.messageElement=this.resultContainer=this.inputEpisodeElem=this.inputSeasonElem=this.searchButtonElem=this.inputWordElem=null;this.setCurrentEpisodeNumber=
function(c){a.currentEpisodeNumber=c};this.setCurrentSeasonNumber=function(c){a.currentSeasonNumber=c};this.init=function(){var c='<div class="subtitles_fll_subtitle_selector_search_container" style="margin:20px 0px;"><div class="subtitles_fll_subtitle_selector_search_container_line1" style="margin:10px 5px; position:relative;"><input class="subtitles_fll_subtitle_selector_input_word" type="text" placeholder="'+b("Please enter a title")+'" style="font-size:18px; margin:5px; padding:0px 15px; width:calc(100% - 90px); background-color:#ddd; border:none; border-radius:30px; height:35px;"><button class="subtitles_fll_subtitle_selector_search_button" style="width:70px; height:35px; border-radius:30px; text-align:center; margin:5px; border:none; color:rgb(221, 221, 221); font-size:12px;">'+
b("Search")+'</button></div><div style=""><span style="margin:10px;">'+b("Season")+'</span><input class="subtitles_fll_subtitle_selector_input_season" type="text" style="font-size:18px;padding:0px 15px;width:60px;background-color:#ddd;border:none;border-radius:30px;height:35px; text-align:right; margin-right:20px;"><span style="margin:10px;">'+b("Episode")+'</span><input class="subtitles_fll_subtitle_selector_input_episode" type="text" style="font-size:18px;padding:0px 15px;width:60px;background-color:#ddd;border:none;border-radius:30px;height:35px; text-align:right;"></div><div class="subtitles_fll_subtitle_selector_search_container_line2" style="margin:10px;"><div style="text-align:right;">by <a href="https://www.opensubtitles.org/" target="_blank">OpenSubtitles.org</a></div></div></div><div class="subtitles_fll_subtitle_selector_result_detail" style="padding:10px; border-top:1px solid #444;"></div><div class="subtitles_fll_subtitle_selector_result_container" style="height:calc(100% - 96px); position:relative;"></div>';
a.element.innerHTML=c;a.hideSearchInterface();c=a.element.getElementsByClassName("subtitles_fll_subtitle_selector_search_container").item(0);a.resultContainer=a.element.getElementsByClassName("subtitles_fll_subtitle_selector_result_container")[0];a.inputWordElem=a.element.getElementsByClassName("subtitles_fll_subtitle_selector_input_word")[0];a.inputWordElem.onkeypress=function(e){13==(e.keyCode||e.charCode||0)&&k()};a.searchButtonElem=a.element.getElementsByClassName("subtitles_fll_subtitle_selector_search_button")[0];
a.searchButtonElem.onclick=k;a.inputSeasonElem=a.element.getElementsByClassName("subtitles_fll_subtitle_selector_input_season")[0];a.inputEpisodeElem=a.element.getElementsByClassName("subtitles_fll_subtitle_selector_input_episode")[0];a.localSubtitle=new SubtitlesForLLLocalSubtitle;a.localSubtitle.init();a.localSubtitle.callback=function(e,d){e?(console.error(e),console.error(d)):(f(subtitlesForLL.currentCatalogId,d.text,d.fileType),a.downloadedSubtitleFileCallback&&a.downloadedSubtitleFileCallback(subtitlesForLL.currentCatalogId,
{SubFormat:d.fileType},d.text,"localSubtitle"))};c.insertAdjacentElement("beforeend",a.localSubtitle.element);a.showLoadingView("")};this.initAllView=function(){a.searchResults=null;a.hideSearchInterface();a.hideLoadingView();a.showLoadingView("");a.removeMessage();a.removeResults();a.hideSearchResultDetail()};this.showSearchInterface=function(){a.element.getElementsByClassName("subtitles_fll_subtitle_selector_search_container")[0].style.display="block"};this.hideSearchInterface=function(){a.element.getElementsByClassName("subtitles_fll_subtitle_selector_search_container")[0].style.display=
"none"};this.setSeasonAndEpisode=function(c,e,d){a.inputSeasonElem.value=e;a.inputEpisodeElem.value=d;""==a.inputWordElem.value&&c&&0<c.length&&(a.inputWordElem.value=c)};this.showLoadingView=function(c){var e=a.element.getElementsByClassName("subtitles_fll_search_loading_view");null==e||0>=e.length?a.element.insertAdjacentHTML("beforeend",'<div class="subtitles_fll_search_loading_view" style="position:absolute; height:100%; z-index:1; top:0; left:0; right:0; bottom:0; margin:0px; background-color:rgba(0,0,0,0.8);"><div style="height:100px;margin:auto 0px;position: absolute;top: 0;bottom: 0;left: 0;right: 0;"><div class="subtitles_fll_loading_text" style="color:#ddd; text-align:center; font-size:16px; margin:20px auto;">'+
c+'</div><div><?xml version="1.0" encoding="utf-8"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin:auto; background:none; display:block; shape-rendering:auto;" width="80px" height="80px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="#dddddd" stroke-width="7" r="32" stroke-dasharray="150.79644737231007 52.26548245743669"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></svg></div></div></div>'):
(e[0].getElementsByClassName("subtitles_fll_loading_text")[0].innerHTML=c,e[0].style.display="block")};this.hideLoadingView=function(){var c=a.element.getElementsByClassName("subtitles_fll_search_loading_view");c&&1<=c.length&&(c[0].style.display="none")};this.showSearchResultDetail=function(c){var e=a.element.getElementsByClassName("subtitles_fll_subtitle_selector_result_detail")[0];e.innerHTML=c;e.style.display="block"};this.hideSearchResultDetail=function(){a.element.getElementsByClassName("subtitles_fll_subtitle_selector_result_detail")[0].style.display=
"none"};this.showMessage=function(c){a.resultContainer.innerHTML='<div class="subtitles_fll_search_result_message_view" style="position:absolute; height:150px; top:0; left:0; right:0; bottom:0; margin:auto;"><div style="color:#ddd; text-align:center; font-size:16px; margin:20px auto;">'+c+"</div></div>"};this.removeMessage=function(){var c=a.element.getElementsByClassName("subtitles_fll_search_result_message_view");c&&1<=c.length&&c[0].remove()};this.showResults=function(c){if(c&&0<c.length){a.resultContainer.innerHTML=
"";var e=document.createElement("div");e.style.cssText="width:100%; margin:0px; color:#ddd;";for(var d=0;d<c.length&&30>d;d++){var m=c[d];if("srt"==m.SubFormat.toLowerCase()||"vtt"==m.SubFormat.toLowerCase()||"ssa"==m.SubFormat.toLowerCase())m=g(m,d,u),e.insertAdjacentElement("beforeend",m)}a.resultContainer.appendChild(e)}};this.removeResults=function(){a.resultContainer.innerHTML=""};this.autoSearch=function(c){a.initAllView();0<a.inputWordElem.value.length&&null==a.inputWordElem.value.match(/^\s*$/m)?
n(a.inputWordElem.value):(a.hideLoadingView(),a.showSearchInterface(),function(e){var d=e&&e.response;if(null==d||(null==d.imdb||0>=d.imdb.length)&&(null==d.recommend||0>=d.recommend.length))c&&c(null);else if(0<d.recommend.length){e=a.element.getElementsByClassName("subtitles_fll_subtitle_selector_result_container").item(0);var m=document.createElement("div");m.style.cssText="padding:20px; border-top:1px solid #444; font-size:15px;";m.innerHTML=b("Other users are watching with such subtitles");e.insertAdjacentElement("beforeend",
m);var w=document.createElement("div");d.recommend.forEach(function(x,D){D=g(x,D,function(p){a.showLoadingView(b("Downloading..."));var C=subtitlesForLL.currentCatalogId,A=d.recommend[p.target.dataset.index];q(A.SubDownloadLink,C,A,function(v){a.hideLoadingView();a.downloadedSubtitleFileCallback&&a.downloadedSubtitleFileCallback(C,A,v,"recommend")})});if(x.IDMovieImdb||x.SeriesIMDBParent){var t='<div style="text-align:center;"><button class="subtitles_fll_same_title_search subtitles_fll_dark_green_link" style="height:35px; font-size:13px; color:#fff; border-radius:20px; text-align:center; margin:20px 0px 10px 0px; padding:0px 20px; outline:none;">'+
b("Search other subtitles of same movie")+"</button></div>";D.insertAdjacentHTML("beforeend",t);w.insertAdjacentElement("beforeend",D);D.getElementsByClassName("subtitles_fll_same_title_search").item(0).onclick=function(p){n("IMDB-ID:"+(x.IDMovieImdb||x.SeriesIMDBParent))}}});e.insertAdjacentElement("beforeend",w)}else 0<d.imdb.length&&(a.inputWordElem.value="IMDB-ID:"+Number(d.imdb[0].id),e="IMDB-ID:"+Number(d.imdb[0].id),a.showLoadingView(b("AUTO_IMDB_SEARCH_MSG_1")+subtitlesForLL.common.escapeHTML(e)+
b("AUTO_IMDB_SEARCH_MSG_2")),e={imdbid:Number(d.imdb[0].id)},m=subtitlesForLL.currentContentId,subtitlesForLL.playbackResources[m]&&(m=subtitlesForLL.playbackResources[m],null!=m.seasonNumber&&(e.season=m.seasonNumber),null!=m.episodeNumber&&(e.episode=m.episodeNumber)),(new SubtitlesForLLOpenSubtitlesOrg).search(e,subtitlesForLL.configs.learningLanguage,function(x,D){a.searchResults=x;a.hideLoadingView();200!=D.status?a.showMessage("<div><p>"+b("OpenSubtitles.org returned an error.")+"</p><p>"+b("ERROR_"+
D.status)+'</p></div><div style="text-align:left; margin:20px;"><p>'+subtitlesForLL.common.deleteTagAndEscapeHTML(D.responseText.substring(0,500))+"</p></div>"):(a.showSearchResultDetail(b("Results for ")+'<b><a href="https://www.imdb.com/title/tt'+Number(d.imdb[0].id)+'" target="_blank">IMDB-ID:'+Number(d.imdb[0].id)+"</a></b>"),x&&0<x.length&&a.showResults(x));c&&c(x,D)}))}(null))};var k=function(c){a.initAllView();n(a.inputWordElem.value)},n=function(c){a.inputWordElem.value=c;var e={},d=c.match(/IMDB-ID:(?:tt)?([0-9]+)/i);
null!=d?e.imdbid=d[1]:e.query=c;0<a.inputSeasonElem.value.length&&(e.season=a.inputSeasonElem.value);0<a.inputEpisodeElem.value.length&&(e.episode=a.inputEpisodeElem.value);a.showLoadingView(b("Searching for subtitles..."));(new SubtitlesForLLOpenSubtitlesOrg).search(e,subtitlesForLL.configs.learningLanguage,function(m,w){a.searchResults=m;a.hideLoadingView();a.showSearchInterface();200!=w.status?a.showMessage("<div><p>"+b("OpenSubtitles.org returned an error.")+"</p><p>"+b("ERROR_"+w.status)+'</p></div><div style="text-align:left; margin:20px;"><p>'+
subtitlesForLL.common.deleteTagAndEscapeHTML(w.responseText.substring(0,500))+"</p></div>"):m&&0<m.length?(e.imdbid?a.showSearchResultDetail(b("Results for ")+'<b><a href="https://www.imdb.com/title/tt'+encodeURIComponent(e.imdbid)+'" target="_blank">IMDB-ID:'+e.imdbid+"</a></b>"):a.showSearchResultDetail(b("Results for ")+"<b>"+subtitlesForLL.common.escapeHTML(e.query)+"</b>"),a.showResults(m)):e.imdbid?a.showSearchResultDetail(b("No results found for ")+'<b><a href="https://www.imdb.com/title/tt'+
encodeURIComponent(e.imdbid)+'" target="_blank">IMDB-ID:'+e.imdbid+"</a></b>"):a.showSearchResultDetail(b("No results found for ")+"<b>"+subtitlesForLL.common.escapeHTML(c)+"</b>")})},u=function(c){var e=a.searchResults[c.target.dataset.index];c=e.SubDownloadLink;a.showLoadingView("\u5b57\u5e55\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u4e2d\u3067\u3059...");var d=subtitlesForLL.currentCatalogId;q(c,d,e,function(m){a.hideLoadingView();a.downloadedSubtitleFileCallback&&a.downloadedSubtitleFileCallback(d,
e,m,"search")})},q=function(c,e,d,m){var w=chrome.extension.connect({name:"Subtitles for Language Learning (Prime Video)"});w.onMessage.addListener(function(x){w.disconnect();w=null;200==x.status?(x=x.response,null!=x&&0<x.length?f(e,x,d.SubFormat):alert("\u5b57\u5e55\u30d5\u30a1\u30a4\u30eb\u304c\u7a7a\u3067\u3059\u3002"),m&&m(x)):(console.warn("opensubtitles.org\u304b\u3089\u306e\u5b57\u5e55\u30d5\u30a1\u30a4\u30ebDL\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002req.status="+x.status),503==x.status?
alert(b("ERROR_503")):alert(b("Could not download subtitles.")+x.status),m&&m(null))});w.postMessage({type:"downloadGZIP",url:c,encoding:d.SubEncoding})},f=function(c,e,d){if(e&&0<e.length){d=!d||"ssa"!=d.toLowerCase()&&"ass"!=d.toLowerCase()?".srt":".ass";c="/"+encodeURIComponent(c)+"_"+subtitlesForLL.configs.learningLanguage+d;var m=chrome.extension.connect({name:"Subtitles for Language Learning (Prime Video)"});m.onMessage.addListener(function(w){m.disconnect();m=null});m.postMessage({type:"saveFile",
filePath:c,text:e})}},g=function(c,e,d){var m=document.createElement("div");m.style.cssText="border-bottom:solid 1px #444;padding:20px;";m.className="subtitles_fll_search_result_cell";var w="#888";"administrator"==c.UserRank||"moderator"==c.UserRank||"subtranslator"==c.UserRank||"super admin"==c.UserRank||"translator"==c.UserRank||"trusted"==c.UserRank?w="#ab9851":"warning"==c.UserRank&&(w="#a05020");var x=b(c.UserRank,"userRank");m.innerHTML=(null!=c.userCount?'<div style="color:#ddd; font-size:16px; font-weight:bold; margin-bottom:10px;">'+
b("USER_COUNT_PREFIX")+subtitlesForLL.common.escapeHTML(c.userCount)+b("USER_COUNT_SUFFIX")+"</div>":"")+'<a class="subtitles_fll_search_result_link" data-index="'+e+'"><div style="pointer-events:none;"><div style="color:#ddd;font-size:18px;color:#5c85ce; margin-bottom:3px; font-weight:bold;">'+subtitlesForLL.common.escapeHTML(c.MovieName)+(c.MovieYear?'<span style="margin-left:5px;">('+subtitlesForLL.common.escapeHTML(c.MovieYear)+")</span>":"")+'</div><div style="color:#ddd; margin-left:20px;">'+
(c.subDownloadsCnt?"<span>"+b("Download")+" : "+Number(c.SubDownloadsCnt).toLocaleString()+"</span>":"")+' <span style="margin-left:10px;">'+b("Language")+" : "+(c.LanguageName?subtitlesForLL.common.escapeHTML(c.LanguageName):"-")+'</span></div><div style="color:#888; width:100%; text-align:right;">'+(null!=c.SubFormat&&0<c.SubFormat.length?'<span style="margin-left:10px;">'+b("File")+" : "+subtitlesForLL.common.escapeHTML(c.SubFormat)+"</span>":"")+'<span style="margin-left:10px;">'+b("Encoding")+
" : "+subtitlesForLL.common.escapeHTML(c.SubEncoding)+"</span>"+(0<c.Score?'<span style="margin-left:10px;">'+b("Score")+" : "+Math.floor(10*c.Score)/10+"</span>":"")+'</div><div style="color:#888; width:100%; text-align:right;">'+(subtitlesForLL.common.escapeHTML(c.UserNickName)?' <span style="margin-left:10px;">by '+subtitlesForLL.common.escapeHTML(c.UserNickName)+"</span>":"")+(x?'<span style="margin-left:2px;color:'+w+';">('+x+")</span>":"")+"</div></div></a>";m.getElementsByClassName("subtitles_fll_search_result_link")[0].onclick=
d;return m}};function SubtitlesForLLUserWordsView(){var a=this,b=subtitlesForLL.localize.localize;this.init=function(){a.element=document.createElement("div");a.element.className="subtitles_fll_user_words_view";a.element.style.cssText="color:#ddd; font-size:14px; overflow-y:scroll; height:calc(100% - 40px);";var u='<div style="height:100%;"><div style="margin:5px;">'+b("USER_WORDS_DESCRIPTION")+" MAX="+subtitlesForLL.USER_WORDS_MAX_COUNT+'</div><div style="margin:5px;">Colors: red, orange, yellow, green</div><table class="subtitles_fll_user_words_table"><thead><tr><th style="padding:0px 5px;">'+
b("Word")+"</th><th>"+b("\u8272")+"</th><th>"+b("Regex")+'</th></tr></thead><tbody class="subtitles_fll_user_words_tbody"></tbody></table><div style="text-align:center; margin:20px;"><button class="subtitles_fll_configs_add_button" style="width:150px; height:35px; text-align:center; border-radius:20px;">'+b("Add")+'</button></div><div style="text-align:center; margin:20px;"><button class="subtitles_fll_configs_save_button" style="width:150px; height:35px; text-align:center; border-radius:20px;">'+
b("Save")+"</button></div>";a.element.innerHTML=u;a.tbodyElem=a.element.querySelector(".subtitles_fll_user_words_tbody");a.element.querySelector(".subtitles_fll_configs_add_button").onclick=function(q){if(a.tbodyElem.childNodes.length>=subtitlesForLL.USER_WORDS_MAX_COUNT)alert("Can not save more than "+subtitlesForLL.USER_WORDS_MAX_COUNT+" words");else{q=document.createElement("tr");var f='<td><input class="subtitles_fll_user_word" type="text" style="width:150px; margin-left:5px;"></input></td><td><input class="subtitles_fll_user_word_color" type="text" style="width:80px;"></input></td><td style="vertical-align:middle; text-align:center;"><input class="subtitles_fll_user_word_is_regex" type="checkbox" style="margin:0px 5px;"></td><td style="vertical-align:middle;"><button class="subtitltes_fll_user_word_delete" style="height:31px; border-radius:15px;">'+
b("Delete")+"</button></td>";q.innerHTML=f;q.querySelector(".subtitltes_fll_user_word_delete").onclick=n;a.tbodyElem.insertAdjacentElement("beforeend",q)}};a.element.getElementsByClassName("subtitles_fll_configs_save_button")[0].onclick=function(q){var f=Object.keys(subtitlesForLL.userWordsColor),g=new Map;a.tbodyElem.childNodes.forEach(function(c){var e=c.querySelector(".subtitles_fll_user_word_is_regex"),d=c.querySelector(".subtitles_fll_user_word");c=c.querySelector(".subtitles_fll_user_word_color");
if(!(null==d.value||0>=d.value.length)){d=d.value;c=c.value;var m=e.checked;-1>=f.indexOf(c)&&(c="red");c=c.toLowerCase();m?e="("+d+")":(e=d.replace(/(\\\*\+\.\?\{\}\(\)\[\]\^\$\|)/g,"\\$1").replace(/ /g,"\\s+"),e=0==subtitlesForLL.languageCode.isNotSeparateLanguage(subtitlesForLL.configs.learningLanguage)?"\\b("+e+")\\b":"("+d+")");dic={color:c,regex:e,isRegex:m};g.set(d,dic)}});subtitlesForLL.userWords=g;subtitlesForLL.configs.userWords=JSON.stringify([].concat($jscomp.arrayFromIterable(g)));chrome.storage.sync.set(subtitlesForLL.configs);
a.callback&&a.callback("save",g)};k()};this.close=function(){a.element.remove();a.element.innerHTML=null;a.element=null};var k=function(){for(var u=subtitlesForLL.userWords,q=u.keys();userWordKey=q.next().value;){var f=u.get(userWordKey),g=document.createElement("tr");f='<td><input class="subtitles_fll_user_word" type="text" value="'+userWordKey+'" style="width:150px; margin-left:5px;"></input></td><td><input class="subtitles_fll_user_word_color" type="text" value="'+f.color+'" style="width:80px;"></input></td><td style="vertical-align:middle; text-align:center;"><input class="subtitles_fll_user_word_is_regex" type="checkbox" style="margin:0px 5px;"'+
(f.isRegex?' checked="checked"':"")+'></td><td style="vertical-align:middle;"><button class="subtitltes_fll_user_word_delete" style="height:31px; border-radius:15px;">'+b("Delete")+"</button></td>";g.innerHTML=f;g.querySelector(".subtitltes_fll_user_word_delete").onclick=n;a.tbodyElem.insertAdjacentElement("beforeend",g)}},n=function(u){u.target.parentElement.parentElement.remove()}};function SubtitlesForLLWordPopupWindow(){function a(g,c,e){for(var d="",m,w=0;w<g.length;w++){0<w&&subtitlesForLL.common.availableLocalTranslate(c,e)&&(d+='<hr style="border:none; border-top:solid 1px #888; margin:0px;">');var x=g[w].meaning;d+='<div style="margin:10px 0px; font-size:'+subtitlesForLL.configs.dictionaryFontSize+'px;">';if(0==w||(g[w].originalWord||g[w].word)!=m)m=g[w].originalWord||g[w].word,d+='<h4 style="margin-bottom:10px; font-size:'+(subtitlesForLL.configs.dictionaryFontSize+
2)+'px !important;">'+m+"</h4>";g[w].reading&&(d+='<p class="subtitles_fll_color_orange">['+g[w].reading+"]</p>");d+="<ul>";var D=void 0;"string"==typeof x?D="en"==c&&"ja"==e?x.split(" / "):"ja"==c&&"en"==e?x.replace(/\/(\([^\)]+\) ?\([2-9]\))/gi,"\n$1").split("\n"):[x]:Array.isArray(x)&&(D=x);x=[];var t="margin-left:"+(subtitlesForLL.configs.dictionaryFontSize+8)+"px; margin-right:0px; margin-bottom:2px; list-style-position:outside;";subtitlesForLL.isRightToLeftLanguage(subtitlesForLL.configs.learningLanguage)&&
(t="margin-right:"+(subtitlesForLL.configs.dictionaryFontSize+8)+"px; margin-left:0px; margin-bottom:2px; list-style-position:outside;");for(var p=0;p<D.length;p++){var C='<li style="'+t+'">';g[w].pos&&(C="es"==c||"es-419"==c?0==g[w].pos.indexOf("{")?C+(g[w].pos+" "):C+("{"+k(g[w].pos)+"} "):C+("["+k(g[w].pos)+"] "));C+=D[p]+"</li>";x.push(C)}0<x.length&&(x=x.join(""),x=x.replace(/(\u300a.+?\u300b|\{.+?\})/g,'<span class="subtitles_fll_color_orange">$1</span>'),x=x.replace(/(\u3008.+?\u3009|\|)/g,
'<span class="subtitles_fll_color_yellow">$1</span>'),x=x.replace(/(\[.+?\]|\(.+?\))/g,'<span class="subtitles_fll_color_green">$1</span>'),"en"==c&&"ja"==e&&(x=x.replace(/\u3008C\u3009/g,'<span class="subtitles_fll_color_darkgray"> \u53ef\u7b97\u540d\u8a5e </span>'),x=x.replace(/\u3008U\u3009/g,'<span class="subtitles_fll_color_darkgray"> \u4e0d\u53ef\u7b97\u540d\u8a5e </span>')),d+=x);g[w].discription&&0<g[w].discription.length&&(g[w].discription=g[w].discription.replace(/([\u300a\{].+?[\u300b\}])/g,
'<span class="subtitles_fll_color_orange">$1</span>'),d+='<li class="subtitles_fll_color_gray">'+g[w].discription+"</li>");g[w].classifiers&&0<g[w].classifiers.length&&(d+='<li class="subtitles_fll_color_gray">'+k("Classifiers")+" : "+g[w].classifiers.join("; ")+"</li>");g[w].synonyms&&0<g[w].synonyms.length&&(d+='<li class="subtitles_fll_color_gray">'+k("Synonyms")+" : "+g[w].synonyms.join("; ")+"</li>");g[w].antonyms&&0<g[w].antonyms.length&&(d+='<li class="subtitles_fll_color_gray">'+k("Antonyms")+
" : "+g[w].antonyms.join("; ")+"</li>");g[w].examples&&0<g[w].examples.length&&(d+='<li class="subtitles_fll_color_gray">'+k("Example")+" : "+g[w].examples.join("; ")+"</li>");g[w].definitions&&0<g[w].definitions.length&&(d+='<li class="subtitles_fll_color_gray">'+k("Definitions")+" : "+g[w].definitions.join("; ")+"</li>");d+="</ul>";d+="</div>"}return d}var b=this,k=subtitlesForLL.localize.localize,n={all:256},u=["red","orange","yellow","green"];this.element=null;this.targetY=this.x=0;this.word=
null;this.isClipMode=this.isLoading=!1;this.clickCallback=null;this.init=function(){b.element=document.createElement("div");b.element.setAttribute("id","subtitles_fll_word_popup_window");b.element.classList.add("word_popup_window_scroll_bar");b.element.style.cssText="font-size:14px; color:#fff; border-radius:10px; max-width:400px; min-height:50px; max-height:calc(100% - 20px); overflow-y:scroll; position:absolute; top:10px; left:10px; z-index:99999; padding:15px 5px; word-break:break-all;";b.element.style.display=
"none";b.element.innerHTML='<div class="subtitles_fll_word_popup_window_menu" style="display:none; height:20px; margin:0px 0px 20px 5px;"><div class="subtitles_fll_user_word_colors" style="margin-left:0px; margin-right:10px; white-space:nowrap;"><span data-index="0" style="display:inline-block; margin-left: 0px; margin-right: 5px; background-color: #D44; width: 20px; height: 20px; border-radius:10px; cursor:pointer;"></span><span data-index="1" style="display:inline-block; margin-left: 0px; margin-right: 5px; background-color: #DA6; width: 20px; height: 20px; border-radius:10px; cursor:pointer;"></span><span data-index="2" style="display:inline-block; margin-left: 0px; margin-right: 5px; background-color: #DD6; width: 20px; height: 20px; border-radius:10px; cursor:pointer;"></span><span data-index="3" style="display:inline-block; margin-left: 0px; margin-right: 5px; background-color: #6B6; width: 20px; height: 20px; border-radius:10px; cursor:pointer;"></span><span data-index="4" style="display:inline-block; margin-left: 0px; margin-right: 5px; background-color: #ddd; width: 20px; height: 20px; border-radius:10px; cursor:pointer;" title="Remove"></span></div><div class="subtitles_fll_word_popup_window_close" style="margin: -10px 0px 0px 0px; width:40px; height:40px; padding:10px; cursor:pointer; border-radius:20px;"><svg viewBox="0 0 612 612" xmlns="http://www.w3.org/2000/svg"><g><line stroke="#dddddd" stroke-linecap="undefined" stroke-linejoin="undefined" id="svg_1" y2="561.45315" x2="561.49999" y1="48.45311" x1="51.5" stroke-width="99" fill="none"/><line stroke="#dddddd" stroke-linecap="undefined" stroke-linejoin="undefined" id="svg_2" y2="562" x2="561" y1="50" x1="50" stroke-width="99" fill="none"/><line transform="rotate(90 305.5,306.00000000000006) " stroke="#dddddd" stroke-linecap="undefined" stroke-linejoin="undefined" id="svg_4" y2="562" x2="561" y1="50" x1="50" stroke-width="99" fill="none"/></g></svg></div></div><div><h4 class="subtitles_fll_word_popup_window_title" style="margin:0px 10px; font-size:'+
(subtitlesForLL.configs.dictionaryFontSize+2)+'px;">\u8abf\u3079\u305f\u5358\u8a9e</h4></div><div class="subtitles_fll_word_popup_window_loading_container"><p class="subtitles_fll_word_popup_window_loading_text" style="margin:0px 10px;"></p></div><div class="subtitles_fll_word_popup_window_meaning" style="margin:0px 10px;">\u5358\u8a9e\u306e\u610f\u5473</div>';b.menuBarElem=b.element.getElementsByClassName("subtitles_fll_word_popup_window_menu")[0];b.titleElem=b.element.getElementsByClassName("subtitles_fll_word_popup_window_title")[0];
b.meaningElem=b.element.getElementsByClassName("subtitles_fll_word_popup_window_meaning")[0];b.loadingContainer=b.element.getElementsByClassName("subtitles_fll_word_popup_window_loading_container")[0];b.loadingTextElem=b.element.getElementsByClassName("subtitles_fll_word_popup_window_loading_text")[0];b.closeContainerElem=b.element.getElementsByClassName("subtitles_fll_word_popup_window_close")[0];b.colorContainerElem=b.element.getElementsByClassName("subtitles_fll_user_word_colors")[0];for(var g=
0;g<b.colorContainerElem.childNodes.length;g++)b.colorContainerElem.childNodes[g].onclick=function(e){e=e.target.dataset.index;var d=b.word.trim().toLowerCase(),m=subtitlesForLL.userWords.get(d);if(4==e)if(m){subtitlesForLL.userWords.delete(d);var w="deleteUserWord"}else return;else{if(subtitlesForLL.userWords.size+1>=subtitlesForLL.USER_WORDS_MAX_COUNT){alert("Can not save more than "+subtitlesForLL.USER_WORDS_MAX_COUNT+" words");return}m=d.replace(/(\\\*\+\.\?\{\}\(\)\[\]\^\$\|)/g,"\\$1").replace(/ /g,
"\\s+");m=0==subtitlesForLL.languageCode.isNotSeparateLanguage(subtitlesForLL.configs.learningLanguage)?"\\b("+m+")\\b":"("+d+")";m={regex:m,color:u[e]};subtitlesForLL.userWords.set(d,m);w="addUserWord"}q(e);subtitlesForLL.configs.userWords=JSON.stringify([].concat($jscomp.arrayFromIterable(subtitlesForLL.userWords)));chrome.storage.sync.set(subtitlesForLL.configs);b.clickCallback&&b.clickCallback(w,{key:d,dic:m})};b.dictionaryLinksElem=f();b.closeContainerElem.insertAdjacentElement("beforebegin",
b.dictionaryLinksElem);subtitlesForLL.isRightToLeftLanguage(subtitlesForLL.configs.learningLanguage)?(b.closeContainerElem.style.marginLeft="0px",b.meaningElem.style.direction="rtl",b.menuBarElem.style.direction="rtl"):(b.closeContainerElem.style.marginRight="0px",b.meaningElem.style.direction="ltr",b.menuBarElem.style.direction="ltr");b.closeContainerElem.onclick=function(){b.hide(!0)};var c=new MutationObserver(function(){c.disconnect();b.refreshPosition(b.targetX,b.targetY);c.observe(b.element,
{childList:!0,characterData:!0,subtree:!0})});c.observe(b.element,{childList:!0,characterData:!0,subtree:!0});return b};var q=function(g){b.colorContainerElem.childNodes.forEach(function(c){c.style.border=null});if(null!=g)b.colorContainerElem.childNodes[g].style.border="2px solid #FFF";else if(g=subtitlesForLL.userWords.get(b.word.toLowerCase()))g=u.indexOf(g.color),b.colorContainerElem.childNodes[g].style.border="2px solid #FFF"},f=function(){var g=document.createElement("div");g.style="margin-left:auto; margin-right:0px;";
var c=subtitlesForLL.configs.learningLanguage,e=subtitlesForLL.configs.nativeLanguage;c=null==subtitlesForLL.configs.userDictionaryRules||null==subtitlesForLL.configs.userDictionaryRules[c]||null==subtitlesForLL.configs.userDictionaryRules[c][e]?subtitlesForLL.common.getDefaultDictionaryRules(c,e):subtitlesForLL.configs.userDictionaryRules[c][e];e={};for(var d=0;d<c.length;e={$jscomp$loop$prop$rule$61:e.$jscomp$loop$prop$rule$61},d++){e.$jscomp$loop$prop$rule$61=c[d];var m=document.createElement("a");
m.style="line-height:20px; margin-right:10px; color:#30b7ec;";m.innerHTML=e.$jscomp$loop$prop$rule$61.name;m.onclick=function(w){return function(x){var D=w.$jscomp$loop$prop$rule$61.url;D=D.replace(/\$WORD/g,encodeURIComponent(b.word));D=D.replace(/\$LEARNING_LANG_GOOGLE/g,subtitlesForLL.languageCode.toGoogleLangCode(subtitlesForLL.configs.learningLanguage));D=D.replace(/\$NATIVE_LANG_GOOGLE/g,subtitlesForLL.languageCode.toGoogleLangCode(subtitlesForLL.configs.nativeLanguage));window.open(D,w.$jscomp$loop$prop$rule$61.name,
"top="+(x.screenY-300)+",left="+(window.screenX+window.outerWidth)+",width=760,height=600")}}(e);g.appendChild(m)}return g};this.changeClipMode=function(g){(b.isClipMode=g)?(q(null),b.dictionaryLinksElem&&(b.dictionaryLinksElem.remove(),b.dictionaryLinksElem=f(),b.closeContainerElem.insertAdjacentElement("beforebegin",b.dictionaryLinksElem)),b.menuBarElem.style.display="flex",b.element.classList.add("popup_window_clip_mode"),g=.9,g<subtitlesForLL.configs.dictionaryBackgroundAlpha&&(g=1),b.element.style.backgroundColor=
"rgba(50,50,50,"+g+")"):(b.menuBarElem.style.display="none",b.element.classList.remove("popup_window_clip_mode"),b.element.style.backgroundColor="rgba(50,50,50,"+subtitlesForLL.configs.dictionaryBackgroundAlpha+")")};this.draw=function(g,c){var e=subtitlesForLL.configs.learningLanguage,d=subtitlesForLL.configs.nativeLanguage;if(c&&c.isSelectedText){g=g.replace(new RegExp("^(?:["+subtitlesForLL.common.separatorRegexNotHyphenApos+"]+)|(?:["+subtitlesForLL.common.separatorRegexNotHyphenApos+"]+$)","gm"),
"");g=g.replace(/\n.*/g,"");var m=n[subtitlesForLL.configs.learningLanguage]||n.all;if(0==subtitlesForLL.common.availableLocalTranslate(e,d)&&g.length>m||256<g.length)return}if(!(0>=g.length))if(e==d)console.warn("fromLang == toLang\u306a\u306e\u3067API\u3067\u610f\u5473\u306f\u8abf\u3079\u307e\u305b\u3093 fromLang = "+e),b.hide(!1);else{b.meaningElem&&(b.meaningElem.innerHTML="");b.word=g;b.titleElem.innerHTML=g;b.titleElem.style.display="block";b.element.style.display="block";b.element.classList.remove("subtitles_fll_fadeout_animation");
c&&1==c.clipMode?b.changeClipMode(!0):b.changeClipMode(!1);c&&c.eventTarget?(m=c.eventTarget.getBoundingClientRect(),b.refreshPosition(m.left,m.top)):b.refreshPosition();b.loadingTextElem.innerHTML=k("Now Loading...");b.loadingContainer.style.display="block";m={};subtitlesForLL.languageCode.isNotSeparateLanguage(e)&&("ja"==e?(m.recursiveSearch=!0,m.enableDecreaseSearch=!0):m.recursiveSearch=!1);var w=chrome.extension.connect({name:"Subtitles for Language Learning (Prime Video)"});w.onMessage.addListener(function(x){w.disconnect();
w=null;if("local"==x.type)var D=x.words;else if("api"==x.type||"googleDict"==x.type){if(0==x.status&&0==x.isError)return;if(200!=x.status){if(0==x.status){if(0==x.isError)return;b.loadingTextElem.innerHTML=k("Connection error");return}b.loadingTextElem.innerHTML=429==x.status&&x.responseText?x.responseText:k("ERROR")+" : "+x.status;return}D=[];if("api"==x.type){if(x.response&&x.response.translations)for(var t=0;t<x.response.translations.length;t++){var p={};p.word=x.response.translations[t].displaySource;
p.meaning=x.response.translations[t].displayTarget;p.pos=x.response.translations[t].posTag;D.push(p)}}else if("googleDict"==x.type&&x.response)if(p=x.response,p.sentences||p.dict||p.alternative_translations&&0<p.alternative_translations.length)p.dict&&0<p.dict.length&&p.dict.forEach(function(A){D.push({word:A.base_form,meaning:A.terms,pos:A.pos})}),p.alternative_translations&&0<p.alternative_translations.length?p.alternative_translations.forEach(function(A){if(!(null==A.alternative||0>=A.alternative.length)){var v=
{};v.word=A.src_phrase;v.meaning=[];A.alternative.forEach(function(l){v.meaning.push(l.word_postproc)});D.push(v)}}):p.sentences&&0<p.sentences.length&&p.sentences.forEach(function(A){A.orig&&A.trans&&D.push({word:A.orig,meaning:A.trans})});else if(Array.isArray(p))if(2<=p.length){t=p[0];p=p[1];if(t&&0<t.length){var C={word:g,meaning:[]};t.forEach(function(A){A[0]&&C.meaning.push(A[0])});D.push(C)}p&&0<p.length&&p.forEach(function(A){var v={word:g,meaning:A[1]};A[0]&&(v.pos=A[0]);D.push(v)})}else p[0]&&
p[0][0]&&p[0][0][0]&&p[0][0][0][0]&&"string"===typeof p[0][0][0][0][0]&&D.push({word:g,meaning:p[0][0][0][0]})}if(null==D||0>=D.length)b.loadingTextElem.innerHTML=k("No results");else{if("ja"==e&&"en"==d){t=[];for(p=0;p<D.length;p++)D[p].originalWord==g&&(t.push(D[p]),D.splice(p,1),p--);D=t.concat(D)}b.loadingContainer.style.display="none";b.titleElem.style.display="none";b.meaningElem&&b.meaningElem.remove();t=a(D,e,d);"local"==x.type&&D&&0<D.length&&"ja"==e&&"en"==d&&(t+='<div style="text-align:right;">by <a href="http://www.edrdg.org/wiki/index.php/JMdict-EDICT_Dictionary_Project" target="_blank">Edict</a></div>');
b.meaningElem.innerHTML=t;b.element.insertAdjacentElement("beforeend",b.meaningElem);c&&c.eventTarget?(x=c.eventTarget.getBoundingClientRect(),b.refreshPosition(x.left,x.top)):b.refreshPosition()}});w.postMessage({type:"searchWord",data:{from:e,to:d,word:g},options:m})}};this.refreshPosition=function(g,c){if(!b.isHidden()&&null!=b.element.parentElement){var e=subtitlesForLL.SUBTITLE_CONTENTS_VIEW_WIDTH;"none"==document.getElementById("subtitles_fll_contents_view").style.display&&(e=0);b.element.style.height=
"auto";if(null!=g&&null!=c)if(g<b.element.parentElement.clientWidth-e){b.element.style.right=null;var d=g-b.element.clientWidth/2;var m=c-b.element.clientHeight-10;10>m&&(b.element.style.height=c-20+"px");b.element.style.maxWidth="400px"}else d=null,m=c-.5*b.element.clientHeight,b.element.style.maxWidth=400>b.element.parentElement.clientWidth-e?""+(b.element.parentElement.clientWidth-e)+"px":"400px";else e=b.element.getBoundingClientRect(),d=e.left,m=e.bottom;m+b.element.clientHeight+10>b.element.parentElement.clientHeight&&
(m=b.element.parentElement.clientHeight-b.element.clientHeight-10);10>m&&(m=10);null!=d&&0>d&&(d=10);b.setPosition(d,m,g,c)}};this.setPosition=function(g,c,e,d){null!=g?(b.x=g,b.element.style.left=""+g+"px"):(b.element.style.left="auto",b.element.style.right=""+subtitlesForLL.SUBTITLE_CONTENTS_VIEW_WIDTH+"px");null!=c&&(b.y=c,b.element.style.top=""+c+"px");e&&(b.targetX=e);d&&(b.targetY=d)};this.hide=function(g){if(!b.isHidden())if(g){if(0==b.element.classList.contains("subtitles_fll_fadeout_animation")){b.element.classList.add("subtitles_fll_fadeout_animation");
var c=function(){b.element.classList.remove("subtitles_fll_fadeout_animation");b.element.style.display="none";b.changeClipMode(!1);b.element.removeEventListener("animationend",c)};b.element.addEventListener("animationend",c)}}else b.element.style.display="none"};this.isHidden=function(){return"none"==b.element.style.display}}SubtitlesForLLWordPopupWindow.isMouseEnterPopupNotSupportLanguage=function(a){return"km"==a||"lo"==a||"my"==a?!0:!1};
